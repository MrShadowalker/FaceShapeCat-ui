import{d as J,f as M,r as z,e as H,n as $,Y as i,a6 as x,ab as R,a9 as r,k as l,E as y,a7 as Q,Z as T,ah as Y,ai as Z}from"./tinymce-vendor-3c2b3d6e.js";import{J as W}from"./useOnlineTest-e4bd8be3-90aac6cd.js";import{useListPage as X}from"./useListPage-66651993.js";import"./index-0f0d0317.js";import{B as ee}from"./index-64ecc8b2.js";import"./index-09260ce4.js";import{ap as C,bs as te}from"./jeecg-online-vendor-f57c6456.js";import oe from"./BasicTable-400bb95b.js";import{Q as ne}from"./index-2ad3f236.js";import{B as re,u as le}from"./useForm-df7d93c5.js";import{C as ae,E as ie}from"./index-37448b2d.js";import"./antd-vue-vendor-05bfa84d.js";import"./componentMap-e2e33057.js";import"./useFormItem-613b6d5d.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./data-9be677e2.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./index-2d7d6454.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JImageUpload-1b0b2e46.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JPopup-8248ac78.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./JTreeSelect-73cfd2cd.js";import"./JEllipsis-242e7bd0.js";import"./JUpload-70acb676.js";import"./index-76418551.js";import"./JSearchSelect-4158b9a9.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./formUtils-09c7de86.js";import"./injectionKey-69710956.js";var se=Object.defineProperty,S=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,F=(e,t,o)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,me=(e,t)=>{for(var o in t||(t={}))ce.call(t,o)&&F(e,o,t[o]);if(S)for(var o of S(t))pe.call(t,o)&&F(e,o,t[o]);return e},w=(e,t,o)=>new Promise((v,f)=>{var b=a=>{try{s(o.next(a))}catch(p){f(p)}},c=a=>{try{s(o.throw(a))}catch(p){f(p)}},s=a=>a.done?v(a.value):Promise.resolve(a.value).then(b,c);s((o=o.apply(e,t)).next())});const ue=(e,t)=>C.get({url:"/online/cgform/button/list/"+e,params:t});function _(e){return C.delete({url:"/online/cgform/button/deleteBatch",params:{ids:e.join(",")}},{joinParamsToUrl:!0})}const de=(e,t)=>t?C.put({url:"/online/cgform/button/edit",params:e}):C.post({url:"/online/cgform/button/add",params:e}),fe=[{title:"按钮编码",align:"center",dataIndex:"buttonCode"},{title:"按钮名称",align:"center",dataIndex:"buttonName"},{title:"按钮样式",align:"center",dataIndex:"buttonStyle",customRender({text:e,record:t}){if(e==="form"){let o=t.optPosition;return e+"("+(o=="2"?"底部":"侧面")+")"}else return e}},{title:"按钮类型",align:"center",dataIndex:"optType"},{title:"排序",align:"center",dataIndex:"orderNum"},{title:"按钮图标",align:"center",dataIndex:"buttonIcon"},{title:"表达式",align:"center",dataIndex:"exp"},{title:"按钮状态",align:"center",dataIndex:"buttonStatus",customRender({text:e}){return e==1?"激活":"未激活"}}],be=[{label:"按钮编码",field:"buttonCode",component:"Input",required:!0},{label:"按钮名称",field:"buttonName",component:"Input",required:!0},{label:"按钮样式",field:"buttonStyle",component:"Select",componentProps:{options:[{label:"Link",value:"link"},{label:"Button",value:"button"},{label:"Form",value:"form"}]},defaultValue:"link"},{label:"按钮位置",field:"optPosition",component:"Select",componentProps:{options:[{label:"侧面",value:"1"},{label:"底部",value:"2"}]},defaultValue:"2",show:({model:e})=>e.buttonStyle==="form"},{label:"按钮类型",field:"optType",component:"Select",componentProps:{options:[{label:"Js",value:"js"},{label:"Action",value:"action"}]},defaultValue:"js"},{label:"排序",field:"orderNum",component:"InputNumber",componentProps:{style:"width: 100%"}},{label:"按钮图标",field:"buttonIcon",component:"Input",helpMessage:"a-icon type"},{label:"表达式",field:"exp",component:"Input"},{label:"按钮状态",field:"buttonStatus",component:"RadioButtonGroup",componentProps:{options:[{label:"激活",value:"1"},{label:"未激活",value:"0"}]},defaultValue:"1"}],ge=J({name:"CustomButtonList",components:{BasicModal:ee,BasicTable:oe,TableAction:ne,BasicForm:re},emits:["register"],setup(){const e=M(""),{doRequest:t,doDeleteRecord:o,tableContext:v}=X({tableProps:{api:n=>ue(e.value,n),columns:fe,canResize:!1,useSearchForm:!1,beforeFetch(n){return Object.assign(n,{column:"orderNum",order:"asc"})}}}),[f,{reload:b},{rowSelection:c,selectedRowKeys:s}]=v,[a,{closeModal:p}]=ae(n=>w(this,null,function*(){e.value=n.row.id,b()})),{aiTestMode:h,genButtons:B}=W(),[k,g]=ie(),m=M(!1),u=z({onRegister:k,title:H(()=>m!=null&&m.value?"修改":"新增"),width:800,confirmLoading:!1,onOk:K,onCancel:g.closeModal});let d={};const[A,{resetFields:j,setFieldsValue:D,validate:N}]=le({schemas:be,showActionButtonGroup:!1});function P(n){return w(this,null,function*(){var I;m.value=n.isUpdate,d=me({},(I=n.record)!=null?I:{}),g.openModal(),yield $(),yield j(),D(d)})}function O(){P({isUpdate:!1})}function V(n){P({isUpdate:!0,record:n})}function L(){p()}function E(){B(e.value)}function G(){return w(this,null,function*(){t(()=>_(s.value))})}function K(){return w(this,null,function*(){try{u.confirmLoading=!0;let n=yield N();n=Object.assign({cgformHeadId:e.value},d,n),yield de(n,m.value),b(),g.closeModal()}finally{u.confirmLoading=!1}})}function U(n){return[{label:"编辑",onClick:()=>V(n)}]}function q(n){return[{label:"删除",popConfirm:{title:"确定删除吗？",placement:"left",confirm:()=>o(()=>_([n.id]))}}]}return{onAdd:O,onBatchDelete:G,aiTestMode:h,onGenButtons:E,registerModal:a,registerTable:f,selectedRowKeys:s,rowSelection:c,onCancel:L,getTableAction:U,getDropDownAction:q,registerForm:A,formModalProps:u}}}),ye={key:0,style:{float:"left"}};function ve(e,t,o,v,f,b){const c=i("a-button"),s=i("a-icon"),a=i("a-menu-item"),p=i("a-menu"),h=i("a-dropdown"),B=i("TableAction"),k=i("BasicTable"),g=i("BasicForm"),m=i("a-spin"),u=i("BasicModal");return x(),R(u,{onRegister:e.registerModal,title:"自定义按钮",width:1200,defaultFullscreen:"",onCancel:e.onCancel},{footer:r(()=>[l(c,{onClick:e.onCancel},{default:r(()=>[y("关闭")]),_:1},8,["onClick"]),e.aiTestMode?(x(),Q("div",ye,[l(c,{onClick:e.onGenButtons},{default:r(()=>[y("生成测试数据")]),_:1},8,["onClick"])])):T("",!0)]),default:r(()=>[l(k,{onRegister:e.registerTable,rowSelection:e.rowSelection},{tableTitle:r(()=>[l(c,{onClick:e.onAdd,type:"primary",preIcon:"ant-design:plus"},{default:r(()=>[y("新增")]),_:1},8,["onClick"]),e.selectedRowKeys.length>0?(x(),R(h,{key:0},{overlay:r(()=>[l(p,null,{default:r(()=>[l(a,{key:"1",onClick:e.onBatchDelete},{default:r(()=>[l(s,{type:"delete"}),y(" 删除 ")]),_:1},8,["onClick"])]),_:1})]),default:r(()=>[l(c,{style:{"margin-left":"8px"}},{default:r(()=>[y(" 批量操作 "),l(s,{type:"down"})]),_:1})]),_:1})):T("",!0)]),action:r(({record:d})=>[l(B,{actions:e.getTableAction(d),dropDownActions:e.getDropDownAction(d)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),l(u,Y(Z(e.formModalProps)),{default:r(()=>[l(m,{spinning:e.formModalProps.confirmLoading},{default:r(()=>[l(g,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},8,["spinning"])]),_:1},16)]),_:1},8,["onRegister","onCancel"])}const xt=te(ge,[["render",ve]]);export{xt as default};
