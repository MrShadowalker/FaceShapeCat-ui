import{f as S,w as J,Y as I,a6 as i,a7 as g,ac as _,k as s,u as e,Z as m,ab as l,aj as Je,a9 as a,E as f,F as K,aa as $,ad as B,q as $e,A as je,ae as Ve,af as qe,ag as Ue,ah as Ge,ai as We}from"./tinymce-vendor-3c2b3d6e.js";import"./index-0f0d0317.js";import{C as Ye}from"./jeecg-online-vendor-f57c6456.js";import Ze from"./OnlineAutoModal-510991eb-fc2dc518.js";import Xe from"./OnlineCustomModal-518ad33c-1d54cb82.js";import j from"./OnlineDetailModal-9675390d-a064b8ad.js";import{e as et}from"./JImportModal-15f7db6a.js";import{p as tt,d as ot}from"./useListButton-cdbab702-1beaee8c.js";import{B as nt,d as rt,D as it,N as at}from"./useExtendComponent-325fe3f1-007b9393.js";import lt from"./OnlineQueryForm-1bfc8320-01818773.js";import st from"./SuperQuery-5d1ca957-03ae60ef.js";import{u as ct}from"./useOnlinePopEvent-687070b7-3b2e3730.js";import pt from"./OnlCgformErpSubTable-54b50eec-5390da9d.js";import{s as V}from"./constant-754f1a9d-eadfd1e1.js";import{d as mt}from"./antd-vue-vendor-05bfa84d.js";import"./index-64ecc8b2.js";import"./OnlineForm-1fa2d893-7d37908f.js";import"./index-09260ce4.js";import"./index-37448b2d.js";import"./useCustomHook-acb00837-32b1f38e.js";import"./CommentPanel-62548135.js";import"./OnlineFormDetail-0e7294ca-faf7dffa.js";import"./DetailForm-424638eb-a0926224.js";import"./index-76418551.js";import"./index-2d7d6454.js";import"./OnlineSubFormDetail-f0d2c016-93cac491.js";import"./cgformState-d9f8ec42-a08af090.js";import"./componentMap-e2e33057.js";import"./index-8e09cdad.js";import"./user.api-367a7bce.js";import"./customExpression-b2f1ff9b.js";import"./useListPage-66651993.js";import"./LinkTableListPiece-8499a318-01ebb291.js";import"./OnlineSelectCascade-4265c95d-4cbe6ffe.js";import"./JModalTip-33c7dc44-1741a3e9.js";import"./SuperQueryValComponent.vue_vue_type_script_lang-e9196096-fd4361e6.js";import ut from"./BasicTable-400bb95b.js";import{Q as dt}from"./index-2ad3f236.js";import"./vxe-table-vendor-26792376.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./useForm-df7d93c5.js";import"./formUtils-09c7de86.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./data-9be677e2.js";import"./useFormItem-613b6d5d.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JPopup-8248ac78.js";import"./JEllipsis-242e7bd0.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JTreeSelect-73cfd2cd.js";import"./JSearchSelect-4158b9a9.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JImageUpload-1b0b2e46.js";import"./JUpload-70acb676.js";import"./injectionKey-69710956.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";var F=(H,C,u)=>new Promise((b,R)=>{var T=r=>{try{c(u.next(r))}catch(k){R(k)}},D=r=>{try{c(u.throw(r))}catch(k){R(k)}},c=r=>r.done?b(r.value):Promise.resolve(r.value).then(T,D);c((u=u.apply(H,C)).next())});const gt={class:"p-2 cgformErpList"},ft={class:"content"},yt={key:0,style:{"font-size":"12px","font-style":"italic"}},ht={key:0,style:{"font-size":"12px","font-style":"italic"}},Ct=["src","onClick"],bt=["innerHTML"],kt=["title"],on={__name:"OnlCgformErpList",setup(H){const C=S([]),u=S(0),b=S(null),{createMessage:R}=Ye(),T=S({}),D=(o,n)=>{T.value[o]=n},{ID:c,onlineTableContext:r,onlineQueryFormOuter:k,loading:L,reload:y,dataSource:O,pagination:q,handleSpecialConfig:U,getColumnList:G,handleChangeInTable:W,loadData:Y,superQueryButtonRef:M,superQueryStatus:Z,handleSuperQuery:X,onlineExtConfigJson:z,handleFormConfig:ee,registerCustomModal:te,tableReloading:oe}=tt({themeTemplate:V});if(!c.value)throw R.warning("地址错误, 配置ID不存在!"),new Error("地址错误, 配置ID不存在!");let{initCgEnhanceJs:ne}=nt(r);const{buttonSwitch:v,cgLinkButtonList:vt,cgTopButtonList:E,importUrl:re,registerModal:ie,handleAdd:ae,handleEdit:wt,handleBatchDelete:le,registerImportModal:se,onImportExcel:ce,onExportExcel:pe,cgButtonJsHandler:me,cgButtonActionHandler:ue,cgButtonLinkHandler:St,handleSubmitFlow:Rt,getDropDownActions:de,getActions:ge,initButtonList:fe,initButtonSwitch:ye,registerDetailModal:he,registerBpmModal:Tt}=ot(r,z,{singleDelCallback:o=>{Array.isArray(r.selectedRowKeys)&&r.selectedRowKeys.includes(o)&&r.clearSelectedRow()},editClickCallback:(o,n)=>{Array.isArray(r.selectedRowKeys)&&r.selectedRowKeys.includes(o)&&n.stopPropagation()}}),P=S(!1);function Ce(){return F(this,null,function*(){try{P.value=!0,yield pe()}finally{setTimeout(()=>P.value=!1,1500)}})}const{columns:be,actionColumn:ke,selectedKeys:w,rowSelection:ve,enableScrollBar:we,tableScroll:Se,downloadRowFile:Re,getImgView:Te,getPcaText:N,getFormatDate:xe,handleColumnResult:Ie,hrefComponent:x,viewOnlineCellImage:_e,hrefMainTableId:Be,registerOnlineHrefModal:De,registerPopModal:Le,openPopModal:Me,onlinePopModalRef:Ee,popTableId:Q}=rt(r,z);J(w,o=>{var n;(n=w.value)!=null&&n.length?b.value=O.value.find(d=>d.id===w.value[0]):b.value=null},{immediate:!0}),J(c,()=>{Pe()},{immediate:!0});function Pe(){return F(this,null,function*(){L.value=!0;let o=yield G(V);Ae(o.main),C.value=o.subList,yield Y(),L.value=!1,r.execButtonEnhance("setup")})}function Ae(o){let n=ne(o.enhanceJs);r.EnhanceJS=n,fe(o.cgButtonList),ye(o.hideColumns),Ie(o,"radio"),U(o)}function Ke(o){r.queryParam=o,y({mode:"search"})}function Fe(){return F(this,arguments,function*(o={}){yield it(M);const n=mt(o),{properties:d={}}=n;Object.entries(d).forEach(([p,A])=>{A.view=="table"&&delete d[p]}),M.value.init(n)})}function He(o){Q.value=o.id;let n={title:o.describe};o.record&&o.record.id&&(n.record=o.record,n.isUpdate=!0),Me(!0,n)}ct(He);const Oe=(o,n)=>{X(o,n),w.value=[]};return(o,n)=>{var d;const p=I("a-button"),A=I("a-tab-pane"),ze=I("a-tabs"),Ne=I("a-modal");return i(),g("div",gt,[_("div",ft,[s(lt,{ref_key:"onlineQueryFormOuter",ref:k,id:e(c),onSearch:Ke,onLoaded:Fe},null,8,["id"]),e(oe)?m("",!0):(i(),l(e(ut),{key:0,ref:"onlineTable",rowKey:"jeecg_row_key",canResize:!0,bordered:!0,showIndexColumn:!1,loading:e(L),columns:e(be),dataSource:e(O),pagination:e(q),rowSelection:e(ve),actionColumn:e(ke),showTableSetting:!0,clickToRowSelect:!0,scroll:e(Se),onTableRedo:e(y),class:Je({"j-table-force-nowrap":e(we)}),onChange:e(W)},{tableTitle:a(()=>[e(v).add?(i(),l(p,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:e(ae)},{default:a(()=>[f("新增")]),_:1},8,["onClick"])):m("",!0),e(v).import?(i(),l(p,{key:1,preIcon:"ant-design:import-outlined",type:"primary",onClick:e(ce)},{default:a(()=>[f("导入")]),_:1},8,["onClick"])):m("",!0),e(v).export?(i(),l(p,{key:2,preIcon:"ant-design:export-outlined",type:"primary",loading:P.value,onClick:Ce},{default:a(()=>[f(" 导出")]),_:1},8,["loading"])):m("",!0),e(E)&&e(E).length>0?(i(!0),g(K,{key:3},$(e(E),(t,h)=>(i(),g(K,null,[t.optType=="js"?(i(),l(p,{key:"cgbtn"+h,onClick:Qe=>e(me)(t.buttonCode),type:"primary",preIcon:t.buttonIcon?"ant-design:"+t.buttonIcon:""},{default:a(()=>[f(B(t.buttonName),1)]),_:2},1032,["onClick","preIcon"])):t.optType=="action"?(i(),l(p,{key:"cgbtn"+h,onClick:Qe=>e(ue)(t.buttonCode),type:"primary",preIcon:t.buttonIcon?"ant-design:"+t.buttonIcon:""},{default:a(()=>[f(B(t.buttonName),1)]),_:2},1032,["onClick","preIcon"])):m("",!0)],64))),256)):m("",!0),e(v).batch_delete?$e((i(),l(p,{key:4,preIcon:"ant-design:delete-outlined",onClick:e(le)},{default:a(()=>[f(" 批量删除")]),_:1},8,["onClick"])),[[je,e(w).length>0]]):m("",!0),e(v).super_query?(i(),l(st,{key:5,ref_key:"superQueryButtonRef",ref:M,online:"",status:e(Z),onSearch:Oe},null,8,["status"])):m("",!0)]),fileSlot:a(({text:t})=>[t?(i(),l(p,{key:1,ghost:!0,type:"primary",preIcon:"ant-design:download",size:"small",onClick:h=>e(Re)(t)},{default:a(()=>[f(" 下载 ")]),_:2},1032,["onClick"])):(i(),g("span",yt,"无文件"))]),imgSlot:a(({text:t})=>[t?(i(),g("img",{key:1,src:e(Te)(t),alt:"图片不存在",class:"online-cell-image",onClick:h=>e(_e)(t)},null,8,Ct)):(i(),g("span",ht,"无图片"))]),htmlSlot:a(({text:t})=>[_("div",{innerHTML:t},null,8,bt)]),pcaSlot:a(({text:t})=>[_("div",{title:e(N)(t)},B(e(N)(t)),9,kt)]),dateSlot:a(({text:t})=>[_("span",null,B(e(xe)(t)),1)]),action:a(({record:t})=>[s(e(dt),{actions:e(ge)(t),dropDownActions:e(de)(t)},null,8,["actions","dropDownActions"])]),_:1},8,["loading","columns","dataSource","pagination","rowSelection","actionColumn","scroll","onTableRedo","class","onChange"])),(d=C.value)!=null&&d.length?(i(),l(ze,{key:1,animated:"",activeKey:u.value,"onUpdate:activeKey":n[0]||(n[0]=t=>u.value=t),style:{margin:"10px"}},{default:a(()=>[(i(!0),g(K,null,$(C.value,(t,h)=>(i(),l(A,{tab:t.description,key:h,forceRender:""},{default:a(()=>[s(pt,{data:t,mainTableSelectedRowRcord:b.value,onGetSource:D},null,8,["data","mainTableSelectedRowRcord"])]),_:2},1032,["tab"]))),128))]),_:1},8,["activeKey"])):m("",!0),s(Ze,{id:e(c),subTableSource:T.value,onRegister:e(ie),onSuccess:e(y),onFormConfig:e(ee)},null,8,["id","subTableSource","onRegister","onSuccess","onFormConfig"]),s(j,{id:e(c),onRegister:e(he)},null,8,["id","onRegister"]),s(et,{onRegister:e(se),url:e(re)(),onOk:e(y),online:""},null,8,["onRegister","url","onOk"]),s(Ne,Ve(e(x).model,qe(e(x).on)),{default:a(()=>[(i(),l(Ue(e(x).is),Ge(We(e(x).params)),null,16))]),_:1},16),s(Xe,{onRegister:e(te),onSuccess:e(y)},null,8,["onRegister","onSuccess"]),s(j,{id:e(Be),onRegister:e(De),defaultFullscreen:!1},null,8,["id","onRegister"]),s(at,{ref_key:"onlinePopModalRef",ref:Ee,id:e(Q),onRegister:e(Le),onSuccess:e(y),request:"",topTip:""},null,8,["id","onRegister","onSuccess"])])])}}};export{on as default};
