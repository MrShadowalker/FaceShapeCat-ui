import{d as h,f as r,a6 as m,a7 as k}from"./tinymce-vendor-3c2b3d6e.js";import{af as u,e as v,I as A,a as y,bn as c,u as _,an as L,C as I,B as T}from"./jeecg-online-vendor-f57c6456.js";import"./antd-vue-vendor-05bfa84d.js";import"./vxe-table-vendor-26792376.js";const S=h({__name:"OAuth2Login",setup(w){const l=r(u()),e=r({thirdApp:!1,wxWork:!1,dingtalk:!1}),{currentRoute:p}=v(),n=p.value;u()||A.replace({path:y.BASE_LOGIN,query:n.query}),l.value&&g();function g(){/wxwork/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.wxWork=!0),/dingtalk/i.test(navigator.userAgent)&&(e.value.thirdApp=!0,e.value.dingtalk=!0),f()}function f(){if(e.value.thirdApp)if(n.query.oauth2LoginToken){let s=n.query.oauth2LoginToken;d({token:s,thirdType:n.query.thirdType,tenantId:L})}else e.value.wxWork?c("wechat_enterprise"):e.value.dingtalk&&c("dingtalk")}function d(s){const a=_(),{notification:o}=I(),{t:i}=T();a.ThirdLogin(s).then(t=>{t&&t.userInfo?o.success({message:i("sys.login.loginSuccessTitle"),description:`${i("sys.login.loginSuccessDesc")}: ${t.userInfo.realname}`,duration:3}):o.error({message:"登录失败",description:((t.response||{}).data||{}).message||t.message||"请求出现错误，请稍后再试",duration:4})})}return(s,a)=>(m(),k("div"))}});export{S as default};
