var m=(i,o,l)=>new Promise((t,p)=>{var r=s=>{try{c(l.next(s))}catch(d){p(d)}},u=s=>{try{c(l.throw(s))}catch(d){p(d)}},c=s=>s.done?t(s.value):Promise.resolve(s.value).then(r,u);c((l=l.apply(i,o)).next())});import{ap as g,_ as R}from"./jeecg-online-vendor-f57c6456.js";import{f,e as B,w as N,Y as _,a6 as I,ab as K,a9 as S,k as v,ac as U,ao as T,ad as H,Z as V}from"./tinymce-vendor-3c2b3d6e.js";import b from"./UserList-9509c9fd.js";import{aQ as z}from"./antd-vue-vendor-05bfa84d.js";import"./vxe-table-vendor-26792376.js";import"./index-37448b2d.js";const A={name:"DepartUserList",components:{UserList:b,FolderFilled:z},props:{searchText:{type:String,default:""},selectedIdList:{type:Array,default:()=>[]},excludeUserIdList:{type:Array,default:()=>[]},multi:{type:Boolean,default:!1}},emits:["loaded","selected","unSelect"],setup(i,{emit:o}){function l(e){return m(this,null,function*(){const a="/sys/sysDepart/queryDepartTreeSync";let n={};return e&&(n.pid=e),yield g.get({url:a,params:n},{isTransformResponse:!1})})}function t(){return m(this,null,function*(){const e=yield l();if(e.success){let a=e.result;r.value=a,p(a)}L()})}function p(e){let a=[];e&&e.length>0&&(a=e.map(n=>({value:n.id,label:n.departName}))),o("loaded",a)}t();const r=f([]),u=f([]),c=f([]),s=f("");function d(e,a){let n=a.node.dataRef;u.value=[n.key];let x=e[0];s.value=x,w()}function L(){s.value=""}function y(e){return m(this,null,function*(){const a=yield l(e.eventKey);if(a.success){let n=a.result;e.dataRef.children=[...n],r.value=[...r.value]}})}const h=f(300);h.value=window.innerHeight-300;const k=B(()=>({"overflow-y":"auto","max-height":h.value+"px"})),D=f([]);function w(){return m(this,null,function*(){const e="/sys/user/selectUserList";let a={pageNo:1,pageSize:10};i.searchText&&(a.keyword=i.searchText),s.value&&(a.departId=s.value);const n=yield g.get({url:e,params:a},{isTransformResponse:!1});if(n.success){const{records:x}=n.result;D.value=x}})}N(()=>i.searchText,()=>{w()});function F(e){o("selected",e)}function C(e){o("unSelect",e)}return{containerStyle:k,treeData:r,selectedKeys:u,expandedKeys:c,onSelect:d,loadChildren:y,onSelectUser:F,unSelectUser:C,userDataList:D}}},q={style:{"margin-left":"5px"}};function E(i,o,l,t,p,r){const u=_("FolderFilled"),c=_("a-tree"),s=_("a-col"),d=_("user-list"),L=_("a-row");return I(),K(L,null,{default:S(()=>[v(s,{span:12},{default:S(()=>[U("div",{style:T(t.containerStyle)},[t.treeData.length>0?(I(),K(c,{key:0,"load-data":t.loadChildren,showIcon:"",autoExpandParent:"",treeData:t.treeData,selectedKeys:t.selectedKeys,expandedKeys:t.expandedKeys,"onUpdate:expandedKeys":o[0]||(o[0]=y=>t.expandedKeys=y),onSelect:t.onSelect},{title:S(({title:y,key:h})=>[v(u,{style:{color:"#9e9e9e"}}),U("span",q,H(y),1)]),_:1},8,["load-data","treeData","selectedKeys","expandedKeys","onSelect"])):V("",!0)],4)]),_:1}),v(s,{span:12,style:{"padding-left":"10px"}},{default:S(()=>[U("div",{style:T(t.containerStyle)},[v(d,{multi:l.multi,excludeUserIdList:l.excludeUserIdList,dataList:t.userDataList,selectedIdList:l.selectedIdList,onSelected:t.onSelectUser,onUnSelect:t.unSelectUser},null,8,["multi","excludeUserIdList","dataList","selectedIdList","onSelected","onUnSelect"])],4)]),_:1})]),_:1})}const J=R(A,[["render",E]]);export{J as default};
