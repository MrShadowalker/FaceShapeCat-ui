var Te=Object.defineProperty;var le=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var ce=(e,c,s)=>c in e?Te(e,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[c]=s,T=(e,c)=>{for(var s in c||(c={}))De.call(c,s)&&ce(e,s,c[s]);if(le)for(var s of le(c))Le.call(c,s)&&ce(e,s,c[s]);return e};var V=(e,c,s)=>new Promise((f,w)=>{var y=p=>{try{d(s.next(p))}catch(i){w(i)}},u=p=>{try{d(s.throw(p))}catch(i){w(i)}},d=p=>p.done?f(p.value):Promise.resolve(p.value).then(y,u);d((s=s.apply(e,c)).next())});import{u as o,e as P,w as X,I as ue,h as Ce,n as ve,d as Ee,r as fe,f as H,o as Re,Y as z,a6 as ee,ab as de,ae as pe,a8 as Se,a9 as K,k as me,ah as te,ai as oe,Q as U,a7 as _e,F as Me,aa as ne,aq as he}from"./tinymce-vendor-3c2b3d6e.js";import{e as se,s as Pe,d as be,aF as $e,a5 as Ne,a6 as We}from"./antd-vue-vendor-05bfa84d.js";import{h as ke,b as He,c as Ae,_ as Ye}from"./FormItem-f39ffb12.js";import{F as qe,c as ze}from"./FormAction-7a06d071.js";import{as as Y,w as J,v as Q,i as G,aY as Ke,aq as Ue,at as Xe,aO as W,az as ye,a6 as Fe,aM as Ge,_ as Je}from"./jeecg-online-vendor-f57c6456.js";import{h as Qe}from"./formUtils-09c7de86.js";import{J as Ze,b as ge,A as ie,p as F,k as xe}from"./index-37448b2d.js";import"./index-64ecc8b2.js";import{u as et}from"./BasicModal-9d388b71.js";import"./ApiRadioGroup-a1926fc5.js";import"./useFormItem-613b6d5d.js";import"./RadioButtonGroup-be3182af.js";import"./ApiSelect-a616c270.js";import"./ApiTreeSelect-7ab64df4.js";import"./index-2ad3f236.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./vxe-table-vendor-26792376.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./JAreaLinkage-60ec0830.js";import"./areaDataUtil-bfcb9e4a.js";import"./data-9be677e2.js";import"./JSelectUser-023ffd97.js";import"./UserSelectModal-e7ea3e82.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-f6a2b32b.js";import"./JSelectPosition-8ff0e3eb.js";import"./PositionSelectModal-78464b4e.js";import"./JSelectRole-2ca1ea2e.js";import"./RoleSelectModal-32681bd6.js";import"./JImageUpload-6faeac18.js";import"./JDictSelectTag-74396fb4.js";import"./CompTypeEnum-5c91fd88.js";import"./JSelectDept-26b8aabf.js";import"./DeptSelectModal-bfb41b56.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./useTreeBiz-a3326efb.js";import"./JAreaSelect-6943c821.js";import"./JEditor-72c28cfe.js";import"./index-13e7f179.js";import"./JMarkdownEditor-805e28d0.js";import"./index-2d7d6454.js";import"./JSelectInput-7c65dd59.js";import"./JCodeEditor-6267f178.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./JCategorySelect-c14709b3.js";import"./JSelectMultiple-02863d2e.js";import"./JPopup-69f13ff9.js";import"./JPopupOnlReportModal-e1cfaee8.js";import"./JSwitch-055650c4.js";import"./JTreeDict-12c42977.js";import"./JInputPop-9a107461.js";import"./EasyCronInput-bc71f27e.js";import"./EasyCronModal-623f3973.js";import"./EasyCronInner-7db9d00a.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./SecondUI-8499e1fa.js";import"./useTabMixin-15a02af3.js";import"./MinuteUI-458ae182.js";import"./HourUI-42b88661.js";import"./DayUI-2d2c9c82.js";import"./MonthUI-704b4fb2.js";import"./WeekUI-36891ade.js";import"./YearUI-5cc291be.js";import"./JCheckbox-d99410ff.js";import"./JInput-32558d47.js";import"./JTreeSelect-e4ac4320.js";import"./JEllipsis-fabea416.js";import"./JSelectUserByDept-72a30e16.js";import"./UserSelectByDepModal-4d6f7985.js";import"./depart.api-76b2f38a.js";import"./JUpload-037dc399.js";import"./index-76418551.js";import"./UploadItemActions-dbfa39da.js";import"./JSearchSelect-220da3dc.js";import"./JAddInput-dec0792b.js";import"./index-3dc0c4fd.js";import"./JRangeNumber-21c95c35.js";import"./index-a68f2c34.js";import"./UserSelectModal-bbf30df5.js";import"./UserList-9509c9fd.js";import"./SelectedUserItem-6a7f0563.js";import"./UserListAndDepart-7270315e.js";import"./UserListAndRole-64eda5ed.js";import"./JRangeDate-e8736b63.js";import"./JRangeTime-687ea499.js";import"./RoleSelectInput-ad21fc36.js";import"./RoleSelectModal-0528d83f.js";import"./useWindowSizeFn-e63bb4b0.js";function tt({defaultValueRef:e,getSchema:c,formModel:s,getProps:f}){function w(u){if(!Y(u))return{};const d={};for(const p of Object.entries(u)){let[,i]=p;const[B]=p;if(!B||J(i)&&i.length===0||Q(i))continue;const g=o(f).transformDateFunc;Y(i)&&(i=g==null?void 0:g(i)),J(i)&&se.isDayjs(i[0])&&se.isDayjs(i[1])&&(i=i.map(m=>g==null?void 0:g(m))),G(i)&&(i=i.trim()),Pe(d,B,i)}return Qe(f,d)}function y(){const u=o(c),d={};u.forEach(p=>{const{defaultValue:i}=p;Ke(i)||(d[p.field]=i,s[p.field]=i)}),e.value=d}return{handleFormValues:w,initDefault:y}}const N=24;function ot({advanceState:e,emit:c,getProps:s,getSchema:f,formModel:w,defaultValueRef:y}){const{realWidthRef:u,screenEnum:d,screenRef:p}=Ze(),i=P(()=>{if(!e.isAdvanced)return 0;const h=o(s).emptySpan||0;if(Ue(h))return h;if(Y(h)){const{span:A=0}=h,O=o(p);return h[O.toLowerCase()]||A||0}return 0}),B=ge(m,30);X([()=>o(f),()=>e.isAdvanced,()=>o(u)],()=>{const{showAdvancedButton:h}=o(s);h&&B()},{immediate:!0});function g(h,A=0,O=!1,R=0){var l;const D=o(u),L=parseInt(h.md)||parseInt(h.xs)||parseInt(h.sm)||h.span||N,j=parseInt(h.lg)||L,C=parseInt(h.xl)||j,t=parseInt(h.xxl)||C;D<=d.LG?A+=L:D<d.XL?A+=j:D<d.XXL?A+=C:A+=t;let n=(l=o(s).autoAdvancedCol)!=null?l:3;return O?(e.hideAdvanceBtn=o(f).length<=n,A>N*2&&A<=N*(o(s).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced,o(f).length>n&&(e.hideAdvanceBtn=!1,e.isAdvanced=!1)),{isAdvanced:e.isAdvanced,itemColSum:A}):A>N*(o(s).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:A}:!e.isAdvanced&&R+1>n?{isAdvanced:!1,itemColSum:A}:{isAdvanced:!0,itemColSum:A}}function m(){let h=0,A=0;const{baseColProps:O={}}=o(s),R=o(f);for(let D=0;D<R.length;D++){const L=R[D],{show:j,colProps:C}=L;let t=!0;if(Xe(j)&&(t=j),Q(j)&&(t=j({schema:L,model:w,field:L.field,values:T(T({},o(y)),w)})),t&&(C||O)){const{itemColSum:n,isAdvanced:l}=g(T(T({},O),C),h,!1,D);h=n||0,l&&(A=h),L.isAdvanced=l}}e.actionSpan=A%N+o(i),g(o(s).actionColOptions||{span:N},h,!0),c("advanced-change")}function k(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:k}}function nt({emit:e,getProps:c,formModel:s,getSchema:f,defaultValueRef:w,formElRef:y,schemaRef:u,handleFormValues:d}){function p(){return V(this,null,function*(){const{resetFunc:t,submitOnReset:n}=o(c);t&&Q(t)&&(yield t()),o(y)&&(Object.keys(s).forEach(r=>{s[r]=w.value[r]}),L(),e("reset",ue(s)),n&&C())})}function i(t){return V(this,null,function*(){const n=o(f).map(r=>r.field).filter(Boolean),l=[];Object.keys(t).forEach(r=>{const v=o(f).find(_=>_.field===r);let b=t[r];if(!(t instanceof Object))return;const S=Reflect.has(t,r);if(b=ke(v==null?void 0:v.component,b),b=He(v==null?void 0:v.component,b),S&&n.includes(r)){if(O(r))if(Array.isArray(b)){const _=[];for(const E of b)_.push(E?W(E):null);s[r]=_}else{const{componentProps:_}=v||{};let E=_;typeof _=="function"&&(E=E({formModel:s})),s[r]=b?E!=null&&E.valueFormat?b:W(b):null}else s[r]=b;l.push(r)}}),R(l).catch(r=>{})})}function B(t){return V(this,null,function*(){const n=be(o(f));if(!t)return;let l=G(t)?[t]:t;G(t)&&(l=[t]);for(const r of l)g(r,n);u.value=n})}function g(t,n){if(G(t)){const l=n.findIndex(r=>r.field===t);l!==-1&&(delete s[t],n.splice(l,1))}}function m(t,n,l=!1){return V(this,null,function*(){const r=be(o(f)),v=r.findIndex(S=>S.field===n);if(r.some(S=>S.field===n||t.field)){if(!n||v===-1||l){l?r.unshift(t):r.push(t),u.value=r;return}v!==-1&&r.splice(v+1,0,t),u.value=r}})}function k(t){return V(this,null,function*(){let n=[];if(Y(t)&&n.push(t),J(t)&&(n=[...t]),!n.every(r=>r.component==="Divider"||Reflect.has(r,"field")&&r.field)){ye("All children of the form Schema array that need to be updated must contain the `field` field");return}u.value=n})}function h(t){return V(this,null,function*(){let n=[];if(Y(t)&&n.push(t),J(t)&&(n=[...t]),!n.every(v=>v.component==="Divider"||Reflect.has(v,"field")&&v.field)){ye("All children of the form Schema array that need to be updated must contain the `field` field");return}const r=[];n.forEach(v=>{o(f).forEach(b=>{if(b.field===v.field){const S=Fe(b,v);r.push(S)}else r.push(b)})}),u.value=$e(r,"field")})}function A(){return o(y)?d(ue(o(s))):{}}function O(t){return o(f).some(n=>n.field===t?Ae.includes(n.component):!1)}function R(t,n){return V(this,null,function*(){var l;return(l=o(y))==null?void 0:l.validateFields(t,n)})}function D(t){return V(this,null,function*(){var n;return yield(n=o(y))==null?void 0:n.validate(t)})}function L(t){return V(this,null,function*(){var n;yield(n=o(y))==null?void 0:n.clearValidate(t)})}function j(t,n){return V(this,null,function*(){var l;yield(l=o(y))==null?void 0:l.scrollToField(t,n)})}function C(t){return V(this,null,function*(){t&&t.preventDefault();const{submitFunc:n}=o(c);if(n&&Q(n)){yield n();return}if(o(y))try{const r=yield D();for(let b in r)r[b]instanceof Array&&Ge(c,b)==="string"&&(r[b]=r[b].join(","));const v=d(r);e("submit",v)}catch(r){e("submit",{})}})}return{handleSubmit:C,clearValidate:L,validate:D,validateFields:R,getFieldsValue:A,updateSchema:h,resetSchema:k,appendSchemaByField:m,removeSchemaByFiled:B,resetFields:p,setFieldsValue:i,scrollToField:j}}function rt(w){return V(this,arguments,function*({getSchema:e,getProps:c,formElRef:s,isInitedDefault:f}){Ce(()=>V(this,null,function*(){if(o(f)||!o(c).autoFocusFirstItem)return;yield ve();const y=o(e),u=o(s),d=u==null?void 0:u.$el;if(!u||!d||!y||y.length===0||!y[0].component.includes("Input"))return;const i=d.querySelector(".ant-row:first-child input");i&&(i==null||i.focus())}))})}const{form:re}=ie,st={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},fieldMapToNumber:{type:Array,default:()=>[]},compact:F.bool,schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:F.bool.def(!0),autoSubmitOnEnter:F.bool.def(!1),submitOnReset:F.bool,size:F.oneOf(["default","small","large"]).def("default"),disabled:F.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:F.bool,transformDateFunc:{type:Function,default:e=>se.isDayjs(e)?e==null?void 0:e.format("YYYY-MM-DD HH:mm:ss"):e},rulesMessageJoinLabel:F.bool.def(!0),autoAdvancedCol:F.number.def(3),autoAdvancedLine:F.number.def(3),alwaysShowLines:F.number.def(1),showActionButtonGroup:F.bool.def(!0),actionColOptions:Object,showResetButton:F.bool.def(!0),autoFocusFirstItem:F.bool,resetButtonOptions:Object,showSubmitButton:F.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:F.bool,labelCol:{type:Object,default:re.labelCol},layout:F.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:{type:Object,default:re.wrapperCol},colon:F.bool.def(re.colon),labelAlign:F.string,rowProps:Object,autoSearch:F.bool.def(!1)},it=Ee({name:"BasicForm",components:{FormItem:Ye,Form:Ne,Row:We,FormAction:qe},props:st,emits:["advanced-change","reset","submit","register"],setup(e,{emit:c,attrs:s}){const f=fe({}),w=et(),y=fe({isAdvanced:!1,hideAdvanceBtn:!0,isLoad:!1,actionSpan:6}),u=H({}),d=H(!1),p=H({}),i=H(null),B=H(null),{prefixCls:g}=xe("basic-form"),m=P(()=>{let a=T(T({},e),o(p));return a.labelWidth&&(a.labelCol=void 0),a.layout==="inline"&&(a.labelCol===ie.form.labelCol&&(a.labelCol=void 0),a.wrapperCol===ie.form.wrapperCol&&(a.wrapperCol=void 0)),a}),k=P(()=>[g,{[`${g}--compact`]:o(m).compact}]),h=P(()=>{const{baseRowStyle:a={},rowProps:I}=o(m);return T({style:a},I)}),A=P(()=>T(T(T({},s),e),o(m))),O=P(()=>{const a=o(i)||o(m).schemas;for(const I of a){const{defaultValue:M,component:je,componentProps:q}=I;if(M&&Ae.includes(je)){let $="";if(q&&($=q==null?void 0:q.valueFormat),!Array.isArray(M))$?I.defaultValue=W(M).format($):I.defaultValue=W(M);else{const x=[];M.forEach(ae=>{$?x.push(W(ae).format($)):x.push(W(ae))}),I.defaultValue=x}}}return o(m).showAdvancedButton?a.filter(I=>I.component!=="Divider"):a}),{handleToggleAdvanced:R}=ot({advanceState:y,emit:c,getProps:m,getSchema:O,formModel:f,defaultValueRef:u}),{handleFormValues:D,initDefault:L}=tt({getProps:m,defaultValueRef:u,getSchema:O,formModel:f});rt({getSchema:O,getProps:m,isInitedDefault:d,formElRef:B});const{handleSubmit:j,setFieldsValue:C,clearValidate:t,validate:n,validateFields:l,getFieldsValue:r,updateSchema:v,resetSchema:b,appendSchemaByField:S,removeSchemaByFiled:_,resetFields:E,scrollToField:we}=nt({emit:c,getProps:m,formModel:f,getSchema:O,defaultValueRef:u,formElRef:B,schemaRef:i,handleFormValues:D});ze({resetAction:E,submitAction:j}),X(()=>o(m).model,()=>{const{model:a}=o(m);a&&C(a)},{immediate:!0}),X(()=>o(m).schemas,a=>{b(a!=null?a:[])}),X(()=>O.value,a=>{ve(()=>{var I;(I=w==null?void 0:w.redoModalHeight)==null||I.call(w)}),!o(d)&&a!=null&&a.length&&(L(),d.value=!0)});function Be(a){return V(this,null,function*(){p.value=Fe(o(p)||{},a)})}const Oe=ge(j,300);function Ie(a,I){f[a]=I,e.autoSearch===!0&&Oe()}function Ve(a){const{autoSubmitOnEnter:I}=o(m);if(I&&a.key==="Enter"&&a.target&&a.target instanceof HTMLElement){const M=a.target;M&&M.tagName&&M.tagName.toUpperCase()=="INPUT"&&j()}}const Z={getFieldsValue:r,setFieldsValue:C,resetFields:E,updateSchema:v,resetSchema:b,setProps:Be,getProps:m,removeSchemaByFiled:_,appendSchemaByField:S,clearValidate:t,validateFields:l,validate:n,submit:j,scrollToField:we};return Re(()=>{L(),c("register",Z)}),T({getBindValue:A,handleToggleAdvanced:R,handleEnterPress:Ve,formModel:f,defaultValueRef:u,advanceState:y,getRow:h,getProps:m,formElRef:B,getSchema:O,formActionType:Z,setFormModel:Ie,getFormClass:k,getFormActionBindProps:P(()=>T(T({},m.value),y))},Z)}});function at(e,c,s,f,w,y){const u=z("FormItem"),d=z("FormAction"),p=z("Row"),i=z("Form");return ee(),de(i,pe(e.getBindValue,{class:e.getFormClass,ref:"formElRef",model:e.formModel,onKeypress:Se(e.handleEnterPress,["enter"])}),{default:K(()=>[me(p,te(oe(e.getRow)),{default:K(()=>[U(e.$slots,"formHeader"),(ee(!0),_e(Me,null,ne(e.getSchema,B=>(ee(),de(u,{key:B.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:B,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel,validateFields:e.validateFields},he({_:2},[ne(Object.keys(e.$slots),g=>({name:g,fn:K(m=>[U(e.$slots,g,te(oe(m||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel","validateFields"]))),128)),me(d,pe(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),he({_:2},[ne(["resetBefore","submitBefore","advanceBefore","advanceAfter"],B=>({name:B,fn:K(g=>[U(e.$slots,B,te(oe(g||{})))])}))]),1040,["onToggleAdvanced"]),U(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["class","model","onKeypress"])}const on=Je(it,[["render",at]]);export{on as default};
