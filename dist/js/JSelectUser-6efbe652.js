var H=Object.defineProperty,N=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var $=(e,t,l)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,O=(e,t)=>{for(var l in t||(t={}))X.call(t,l)&&$(e,l,t[l]);if(L)for(var l of L(t))Y.call(t,l)&&$(e,l,t[l]);return e},k=(e,t)=>N(e,W(t));import{d as P,f as d,u as I,w as V,Y as p,a6 as z,a7 as A,k as r,ae as _,a9 as v,ac as q,r as Q,p as U,h as Z}from"./tinymce-vendor-3c2b3d6e.js";import{aA as ee,ar as E,X as te,_ as J}from"./jeecg-online-vendor-f57c6456.js";import{B as ae}from"./index-64ecc8b2.js";import{C as le,W as K,p as x,E as ne}from"./index-37448b2d.js";import{u as se}from"./useSelectBiz-b5c21498.js";import{s as oe}from"./props-ea47501e.js";import{J as ie}from"./JSelectBiz-b887fca6.js";import{useRuleFormItem as re}from"./useFormItem-613b6d5d.js";const ce=P({name:"UserSelectModal",components:{BasicModal:ae,BasicTable:ee(()=>te(()=>import("./BasicTable-400bb95b.js"),["js/BasicTable-400bb95b.js","js/tinymce-vendor-3c2b3d6e.js","js/antd-vue-vendor-05bfa84d.js","js/index-09260ce4.js","js/useForm-df7d93c5.js","js/componentMap-e2e33057.js","js/jeecg-online-vendor-f57c6456.js","js/vxe-table-vendor-26792376.js","assets/jeecg-online-vendor-13f1d32d.css","js/useFormItem-613b6d5d.js","js/index-37448b2d.js","assets/index-c9eb9973.css","js/index-2ad3f236.js","js/index-64ecc8b2.js","js/BasicModal-9d388b71.js","js/useWindowSizeFn-e63bb4b0.js","assets/BasicModal-d929f5ce.css","assets/index-ad7edbf1.css","js/download-2caf3e60.js","js/base64Conver-fa2fe1af.js","assets/index-18609d1f.css","js/index-ee632f67.js","assets/index-59756ec7.css","js/index-b5f97370.js","js/useCountdown-d833a954.js","js/useFormItemSingle-4fd81116.js","assets/index-15cc10f8.css","js/JAddInput-a2153936.js","js/areaDataUtil-10873080.js","js/data-9be677e2.js","js/useSelectBiz-b5c21498.js","js/props-ea47501e.js","js/JSelectBiz-b887fca6.js","assets/JSelectBiz-ba37f0a8.css","js/index-2d7d6454.js","assets/index-ec16e2f2.css","js/htmlmixed-6ab39e30.js","js/codemirror-vendor-0a03fef5.js","js/vue-41a95ea0.js","assets/vue-8a3c1e84.css","js/anyword-hint-577f8e6e.js","assets/anyword-hint-77cb08a2.css","js/index-d4a67b72.js","js/bem-a6e46c9e.js","js/props-3977d3d5.js","js/useContextMenu-3e9e42e0.js","assets/useContextMenu-aed8cfe5.css","assets/index-a95e0833.css","js/depart.api-76b2f38a.js","assets/JAddInput-c8b88b61.css","assets/idea-2e5fc283.css","js/JImageUpload-1b0b2e46.js","assets/JImageUpload-d7ba7f20.css","js/JDictSelectTag-f0227cc5.js","js/CompTypeEnum-5c91fd88.js","js/JSelectDept-073e3b74.js","js/useTreeBiz-a3326efb.js","assets/JSelectDept-2ce3f5d2.css","js/JEditor-75d90eae.js","js/index-13e7f179.js","js/JPopup-8248ac78.js","assets/JPopup-2f2ed00d.css","js/cron-parser-vendor-a4cfb0b0.js","js/JTreeSelect-73cfd2cd.js","js/JEllipsis-242e7bd0.js","js/JUpload-70acb676.js","js/index-76418551.js","assets/index-27837f17.css","assets/JUpload-557f03ea.css","js/JSearchSelect-4158b9a9.js","js/index-3dc0c4fd.js","js/index-aba90786.js","assets/index-d42612fa.css","assets/componentMap-5d3b78c7.css","js/formUtils-09c7de86.js","assets/useForm-9101c3b7.css","js/injectionKey-69710956.js","assets/BasicTable-18d268be.css"]),{loading:!0})},props:k(O({},oe),{modalTitle:{type:String,default:"选择用户"},excludeUserIdList:{type:Array,default:[]}}),emits:["register","getSelectResult"],setup(e,{emit:t,refs:l}){const u=d({x:!1}),o=d(),[c,{closeModal:s}]=le(()=>{window.innerWidth<900?u.value={x:900}:u.value={x:!1},setTimeout(()=>{o.value&&o.value.setSelectedRowKeys(C.value||[])},800)}),a=E(),h={canResize:!1,bordered:!0,size:"small"},f=Object.assign({},I(e),I(a),h),[{rowSelection:m,visibleChange:g,selectValues:C,indexColumnProps:y,getSelectResult:b,handleDeleteSelected:R,selectRows:B}]=se(K,f),n=d(e.params);V(m.selectedRowKeys,i=>{o.value&&o.value.setSelectedRowKeys(i)});const w={baseColProps:{xs:24,sm:8,md:6,lg:8,xl:6,xxl:6},actionColOptions:{xs:24,sm:8,md:8,lg:8,xl:8,xxl:8},schemas:[{label:"账号",field:"username",component:"JInput"},{label:"姓名",field:"realname",component:"JInput"}]},F=[{title:"用户账号",dataIndex:"username",width:120,align:"left"},{title:"用户姓名",dataIndex:"realname",width:120},{title:"性别",dataIndex:"sex_dictText",width:50},{title:"手机号码",dataIndex:"phone",width:120},{title:"邮箱",dataIndex:"email"},{title:"状态",dataIndex:"status_dictText",width:80}],j={pagination:!1,showIndexColumn:!1,scroll:{y:390},size:"small",canResize:!1,bordered:!0,rowKey:"id",columns:[{title:"用户姓名",dataIndex:"realname",width:40},{title:"操作",dataIndex:"action",align:"center",width:40,slots:{customRender:"action"}}]};function D(){b((i,S)=>{t("getSelectResult",i,S),s()})}function G(i){let S=e.excludeUserIdList;if(!S)return i;let T=[];if(S.length>0&&i&&i.length>0){for(let M of i)S.indexOf(M.id)<0&&T.push(O({},M));return T}return i}return{handleOk:D,searchInfo:n,register:c,indexColumnProps:y,visibleChange:g,getBindValue:f,getUserList:K,formConfig:w,columns:F,rowSelection:m,selectRows:B,selectedTable:j,handleDeleteSelected:R,tableScroll:u,tableRef:o,afterFetch:G}}}),de=["onClick"];function ue(e,t,l,u,o,c){const s=p("BasicTable"),a=p("a-col"),h=p("Icon"),f=p("a-row"),m=p("BasicModal");return z(),A("div",null,[r(m,_(e.$attrs,{onRegister:e.register,title:e.modalTitle,width:e.showSelected?"1200px":"900px",wrapClassName:"j-user-select-modal",onOk:e.handleOk,destroyOnClose:"",onVisibleChange:e.visibleChange}),{default:v(()=>[r(f,null,{default:v(()=>[r(a,{span:e.showSelected?18:24},{default:v(()=>[r(s,_({ref:"tableRef",columns:e.columns,scroll:e.tableScroll},e.getBindValue,{useSearchForm:!0,formConfig:e.formConfig,api:e.getUserList,searchInfo:e.searchInfo,rowSelection:e.rowSelection,indexColumnProps:e.indexColumnProps,afterFetch:e.afterFetch}),{tableTitle:v(()=>[]),_:1},16,["columns","scroll","formConfig","api","searchInfo","rowSelection","indexColumnProps","afterFetch"])]),_:1},8,["span"]),r(a,{span:e.showSelected?6:0},{default:v(()=>[r(s,_(e.selectedTable,{dataSource:e.selectRows,useSearchForm:!0,formConfig:{showActionButtonGroup:!1,baseRowStyle:{minHeight:"40px"}}}),{action:v(({record:g})=>[q("a",{href:"javascript:void(0)",onClick:C=>e.handleDeleteSelected(g)},[r(h,{icon:"ant-design:delete-outlined"})],8,de)]),_:1},16,["dataSource"])]),_:1},8,["span"])]),_:1})]),_:1},16,["onRegister","title","width","onOk","onVisibleChange"])])}const fe=J(ce,[["render",ue]]),me=P({name:"JSelectUser",components:{UserSelectModal:fe,JSelectBiz:ie},inheritAttrs:!1,props:{value:x.oneOfType([x.string,x.array]),labelKey:{type:String,default:"realname"},rowKey:{type:String,default:"username"},params:{type:Object,default:()=>{}},excludeUserIdList:{type:Array,default:()=>[]}},emits:["options-change","change","update:value"],setup(e,{emit:t}){const l=d(),[u,{openModal:o}]=ne(),[c]=re(e,"value","change",l),s=d([]);let a=Q({value:[],change:!1});const h=d(!1);U("selectOptions",s),U("selectValues",a),U("loadingEcho",h);const f=d(!1),m=E();Z(()=>{e.value&&y(),e.value||(a.value=[])}),V(a,()=>{a&&(c.value=a.value)});const g=d([]);V(()=>e.excludeUserIdList,n=>{g.value=n},{immediate:!0});function C(){f.value=!0,o(!0,{isUpdate:!1})}function y(){let n=e.value?e.value:[];n&&typeof n=="string"&&n!="null"&&n!="undefined"?(c.value=n.split(","),a.value=n.split(",")):a.value=n}function b(n,w){s.value=n,c.value=w,a.value=w,t("update:value",w.join(","))}const R=Object.assign({},I(e),I(m));function B(n){t("update:value",n)}return{state:c,attrs:m,selectOptions:s,getBindValue:R,selectValues:a,loadingEcho:h,tag:f,regModal:u,setValue:b,handleOpen:C,excludeUserIdList:g,handleChange:B}}});function pe(e,t,l,u,o,c){const s=p("JSelectBiz"),a=p("UserSelectModal");return z(),A("div",null,[r(s,_({onChange:e.handleChange,onHandleOpen:e.handleOpen,loading:e.loadingEcho},e.attrs),null,16,["onChange","onHandleOpen","loading"]),r(a,_({rowKey:e.rowKey,onRegister:e.regModal,onGetSelectResult:e.setValue},e.getBindValue,{excludeUserIdList:e.excludeUserIdList}),null,16,["rowKey","onRegister","onGetSelectResult","excludeUserIdList"])])}const be=J(me,[["render",pe],["__scopeId","data-v-00f5e96f"]]);export{fe as U,be as u};
