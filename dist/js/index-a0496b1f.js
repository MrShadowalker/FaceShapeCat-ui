var W=Object.defineProperty,tt=Object.defineProperties;var ot=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable;var v=(n,o,e)=>o in n?W(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,D=(n,o)=>{for(var e in o||(o={}))et.call(o,e)&&v(n,e,o[e]);if(x)for(var e of x(o))nt.call(o,e)&&v(n,e,o[e]);return n},R=(n,o)=>tt(n,ot(o));var d=(n,o,e)=>new Promise((_,f)=>{var g=a=>{try{l(e.next(a))}catch(u){f(u)}},w=a=>{try{l(e.throw(a))}catch(u){f(u)}},l=a=>a.done?_(a.value):Promise.resolve(a.value).then(g,w);l((e=e.apply(n,o)).next())});import{d as T,e as it,Y as c,a6 as B,a7 as rt,k as i,a9 as s,E as h,u as r,ab as at,Z as st,aj as lt,ac as U,I as pt}from"./tinymce-vendor-3c2b3d6e.js";import"./index-0f0d0317.js";import"./index-64ecc8b2.js";import{useListPage as mt}from"./useListPage-66651993.js";import ct from"./TemplateModal-8713cb40.js";import ut from"./TemplateTestModal-ca1832f7.js";import{l as dt,c as ft,d as _t,A as M,e as gt,s as A}from"./template.api-1aebfea0.js";import{C as wt}from"./jeecg-online-vendor-f57c6456.js";import{E as I}from"./index-37448b2d.js";import{Q as Ct}from"./index-2ad3f236.js";import bt from"./BasicTable-400bb95b.js";import"./antd-vue-vendor-05bfa84d.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./index-09260ce4.js";import"./useForm-df7d93c5.js";import"./componentMap-e2e33057.js";import"./useFormItem-613b6d5d.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./data-9be677e2.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./index-2d7d6454.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JImageUpload-1b0b2e46.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JPopup-8248ac78.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./JTreeSelect-73cfd2cd.js";import"./JEllipsis-242e7bd0.js";import"./JUpload-70acb676.js";import"./index-76418551.js";import"./JSearchSelect-4158b9a9.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";import"./formUtils-09c7de86.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./injectionKey-69710956.js";import"./validator-a0d2ebc7.js";import"./user.api-367a7bce.js";const ht=U("span",null,"删除",-1),yt=U("span",null,"批量操作",-1),kt=T({name:"message-template"}),Eo=T(R(D({},kt),{setup(n){const{createMessage:o}=wt(),{prefixCls:e,onExportXls:_,onImportXls:f,tableContext:g}=mt({designScope:"message-template",tableProps:{title:"消息中心模板列表数据",api:dt,columns:ft,formConfig:{schemas:_t}},exportConfig:{url:M.exportXls,name:"消息中心模板列表"},importConfig:{url:M.importXls,success:()=>l()}}),[w,{reload:l,setLoading:a},{rowSelection:u,selectedRowKeys:C,selectedRows:E}]=g,[N,{openModal:b}]=I(),[j,F]=I(),V=it(()=>C.value.length>0);function X(){b(!0,{title:"新增消息模板",isUpdate:!1,showFooter:!0,record:{}})}function L(t){if(t.useStatus==="1"){o.warning("此模板已被应用，禁止编辑!");return}b(!0,{title:"修改消息模板",isUpdate:!0,record:t,showFooter:!0})}function K(t){if(t){if(t.useStatus=="1"){o.warning("该模板已被应用禁止删除!");return}y([t.id],!1)}}function y(t,m=!0){return d(this,null,function*(){const p=r(t);if(p.length>0)try{a(!0),yield gt({ids:p.join(",")},m),yield l()}finally{a(!1)}})}function P(){return d(this,null,function*(){try{if(pt(E.value).filter(p=>p.useStatus=="1").length>0){o.warning("选中的模板已被应用禁止删除!");return}yield y(C),C.value=[]}finally{}})}function $(t){F.openModal(!0,{record:t})}function z(t){return[{label:"查看",onClick:Z.bind(null,t)},{label:"编辑",onClick:L.bind(null,t)}]}function O(t){return[{label:"应用",onClick:Q.bind(null,t)},{label:"停用",onClick:Y.bind(null,t)},{label:"发送测试",onClick:$.bind(null,t)},{label:"删除",color:"error",popConfirm:{title:"确认要删除吗？",confirm:K.bind(null,t)}}]}function Q(t){return d(this,null,function*(){let m={id:t.id,useStatus:"1"};yield A(m,!0),yield l()})}function Y(t){return d(this,null,function*(){let m={id:t.id,useStatus:"0"};yield A(m,!0),yield l()})}function Z(t){b(!0,{title:"消息模板详情",isUpdate:!0,showFooter:!1,record:t})}return(t,m)=>{const p=c("a-button"),q=c("j-upload-button"),k=c("Icon"),G=c("a-menu-item"),H=c("a-menu"),J=c("a-dropdown");return B(),rt("div",{class:lt(r(e))},[i(r(bt),{onRegister:r(w),rowSelection:r(u)},{tableTitle:s(()=>[i(p,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:X},{default:s(()=>[h("新增")]),_:1}),i(p,{type:"primary",preIcon:"ant-design:export-outlined",onClick:r(_)},{default:s(()=>[h(" 导出")]),_:1},8,["onClick"]),i(q,{type:"primary",preIcon:"ant-design:import-outlined",onClick:r(f)},{default:s(()=>[h("导入")]),_:1},8,["onClick"]),V.value?(B(),at(J,{key:0},{overlay:s(()=>[i(H,null,{default:s(()=>[i(G,{key:"1",onClick:P},{default:s(()=>[i(k,{icon:"ant-design:delete-outlined"}),ht]),_:1})]),_:1})]),default:s(()=>[i(p,null,{default:s(()=>[yt,i(k,{icon:"mdi:chevron-down"})]),_:1})]),_:1})):st("",!0)]),action:s(({record:S})=>[i(r(Ct),{actions:z(S),dropDownActions:O(S)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),i(ct,{onRegister:r(N),onSuccess:r(l)},null,8,["onRegister","onSuccess"]),i(ut,{onRegister:r(j)},null,8,["onRegister"])],2)}}}));export{Eo as default};
