var m=(f,S,y)=>new Promise((V,p)=>{var g=r=>{try{_(y.next(r))}catch(o){p(o)}},E=r=>{try{_(y.throw(r))}catch(o){p(o)}},_=r=>r.done?V(r.value):Promise.resolve(r.value).then(g,E);_((y=y.apply(f,S)).next())});import{d as ie,c as ae,f as i,Y as u,a6 as c,ab as d,a9 as a,k as A,a7 as ne,E as pe,Z as h,u as M,ac as U,ad as le,F as se,a4 as me,a5 as ce,n as q}from"./tinymce-vendor-3c2b3d6e.js";import"./index-64ecc8b2.js";import{C as ue,aQ as de,_ as fe}from"./jeecg-online-vendor-f57c6456.js";import{q as P,d as ye,A as j}from"./depart.api-76b2f38a.js";import{s as ve}from"./depart.user.api-f634a469.js";import _e from"./DepartFormModal-c358b1e0.js";import{q as he}from"./antd-vue-vendor-05bfa84d.js";import{E as ge}from"./index-37448b2d.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./BasicForm-794b8128.js";import"./FormItem-f39ffb12.js";import"./ApiRadioGroup-a1926fc5.js";import"./useFormItem-613b6d5d.js";import"./RadioButtonGroup-be3182af.js";import"./ApiSelect-a616c270.js";import"./ApiTreeSelect-7ab64df4.js";import"./index-2ad3f236.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./JAreaLinkage-60ec0830.js";import"./areaDataUtil-bfcb9e4a.js";import"./data-9be677e2.js";import"./JSelectUser-023ffd97.js";import"./UserSelectModal-e7ea3e82.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-f6a2b32b.js";import"./JSelectPosition-8ff0e3eb.js";import"./PositionSelectModal-78464b4e.js";import"./JSelectRole-2ca1ea2e.js";import"./RoleSelectModal-32681bd6.js";import"./JImageUpload-6faeac18.js";import"./JDictSelectTag-74396fb4.js";import"./CompTypeEnum-5c91fd88.js";import"./JSelectDept-26b8aabf.js";import"./DeptSelectModal-bfb41b56.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./useTreeBiz-a3326efb.js";import"./JAreaSelect-6943c821.js";import"./JEditor-72c28cfe.js";import"./index-13e7f179.js";import"./JMarkdownEditor-805e28d0.js";import"./index-2d7d6454.js";import"./JSelectInput-7c65dd59.js";import"./JCodeEditor-6267f178.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./JCategorySelect-c14709b3.js";import"./JSelectMultiple-02863d2e.js";import"./JPopup-69f13ff9.js";import"./JPopupOnlReportModal-e1cfaee8.js";import"./JSwitch-055650c4.js";import"./JTreeDict-12c42977.js";import"./JInputPop-9a107461.js";import"./EasyCronInput-bc71f27e.js";import"./EasyCronModal-623f3973.js";import"./EasyCronInner-7db9d00a.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./SecondUI-8499e1fa.js";import"./useTabMixin-15a02af3.js";import"./MinuteUI-458ae182.js";import"./HourUI-42b88661.js";import"./DayUI-2d2c9c82.js";import"./MonthUI-704b4fb2.js";import"./WeekUI-36891ade.js";import"./YearUI-5cc291be.js";import"./JCheckbox-d99410ff.js";import"./JInput-32558d47.js";import"./JTreeSelect-e4ac4320.js";import"./JEllipsis-fabea416.js";import"./JSelectUserByDept-72a30e16.js";import"./UserSelectByDepModal-4d6f7985.js";import"./JUpload-037dc399.js";import"./index-76418551.js";import"./UploadItemActions-dbfa39da.js";import"./JSearchSelect-220da3dc.js";import"./JAddInput-dec0792b.js";import"./index-3dc0c4fd.js";import"./JRangeNumber-21c95c35.js";import"./index-a68f2c34.js";import"./UserSelectModal-bbf30df5.js";import"./UserList-9509c9fd.js";import"./SelectedUserItem-6a7f0563.js";import"./UserListAndDepart-7270315e.js";import"./UserListAndRole-64eda5ed.js";import"./JRangeDate-e8736b63.js";import"./JRangeTime-687ea499.js";import"./RoleSelectInput-ad21fc36.js";import"./RoleSelectModal-0528d83f.js";import"./FormAction-7a06d071.js";import"./formUtils-09c7de86.js";import"./componentMap-e2e33057.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./JSelectBiz-b887fca6.js";import"./JSelectUser-6efbe652.js";import"./JImageUpload-1b0b2e46.js";import"./JDictSelectTag-f0227cc5.js";import"./JSelectDept-073e3b74.js";import"./JEditor-75d90eae.js";import"./JPopup-8248ac78.js";import"./JTreeSelect-73cfd2cd.js";import"./JEllipsis-242e7bd0.js";import"./JUpload-70acb676.js";import"./JSearchSelect-4158b9a9.js";import"./index-aba90786.js";import"./depart.data-bcb499f4.js";const F=f=>(me("data-v-ed2dc5cd"),f=f(),ce(),f),ke=F(()=>U("span",{style:{color:"black"}},"编辑",-1)),xe=F(()=>U("span",{style:{color:"red"}},"删除",-1)),De=ie({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(f,{expose:S,emit:y}){const V=ae("prefixCls"),p=y,{createMessage:g}=ue(),{handleImportXls:E,handleExportXls:_}=de(),r=i(!1),o=i([]),k=i([]),l=i([]),x=i([]),I=i(!1),Ce=i(!0),D=i(null),K=i(null),O=i(""),[Q,{openModal:B}]=ge();function v(){return m(this,null,function*(){try{r.value=!0,o.value=[];const e=yield P();if(Array.isArray(e)&&(o.value=e),l.value.length===0)X();else if(x.value.length===0){let t=o.value[0];t&&C(t.id,t)}else p("select",D.value);p("rootTreeData",o.value)}finally{r.value=!1}})}v();function R(e){return m(this,null,function*(){try{const t=yield P({pid:e.dataRef.id});if(t.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=t,l.value.length>0){let n=[];for(let T of l.value)t.findIndex(b=>b.id===T)!==-1&&n.push(T);n.length>0&&(l.value=[...l.value])}o.value=[...o.value],p("rootTreeData",o.value)}catch(t){}return Promise.resolve()})}function X(){let e=o.value[0];e?(e.isLeaf||(l.value=[e.key]),C(e.id,e),W()):p("select",null)}function W(){return m(this,null,function*(){yield q(),I.value=!0,yield q(),I.value=!1})}function C(e,t){x.value=[e],t&&(D.value=t,p("select",t))}function Te(){B(!0,{isUpdate:!1,isChild:!1})}function Y(e=D.value){if(e==null){g.warning("请先选择一个仓库");return}B(!0,{isUpdate:!0,isChild:!0,record:e})}function Z(e=D.value){if(e==null){g.warning("请先选择一个仓库");return}const t={parentId:e.id};B(!0,{isUpdate:!1,record:t})}function we(e){return m(this,null,function*(){if(e)try{r.value=!0,o.value=[];let t=yield ve({keyWord:e});Array.isArray(t)&&(o.value=t),X()}finally{r.value=!1}else v();O.value=e})}function z(e){Array.isArray(e)?k.value=e:k.value=e.checked}function G(e,t){e.length>0&&x.value[0]!==e[0]?C(e[0],t.selectedNodes[0]):C(x.value[0])}function $(e,t=!0){return m(this,null,function*(){const n=M(e);if(n.length>0)try{r.value=!0,yield ye({ids:n.join(",")},t),yield v()}finally{r.value=!1}})}function H(e){return m(this,null,function*(){e&&(N(!1),$([e.id],!1))})}function Ae(){return m(this,null,function*(){try{yield $(k),k.value=[]}finally{}})}function N(e){e||(K.value=null)}function Se(e){E(e,j.importExcelUrl,()=>{v()})}function Ee(){_("仓库信息",j.exportXlsUrl)}return S({loadRootTreeData:v}),(e,t)=>{const n=u("a-menu-item"),T=u("a-menu"),b=u("a-dropdown"),J=u("a-tree"),ee=u("a-empty"),te=u("a-spin"),oe=u("a-card");return c(),d(oe,{bordered:!1,style:{height:"100%"}},{default:a(()=>[A(te,{spinning:r.value},{default:a(()=>[o.value.length>0?(c(),ne(se,{key:0},[I.value?h("",!0):(c(),d(J,{key:0,clickRowToExpand:!1,treeData:o.value,"load-data":R,expandedKeys:l.value,"onUpdate:expandedKeys":t[1]||(t[1]=w=>l.value=w),onCheck:z,onSelect:G},{title:a(({key:w,title:re,dataRef:s})=>[A(b,{trigger:["contextmenu"]},{overlay:a(()=>[s.orgType==="1"||s.orgType==="2"?(c(),d(T,{key:0,onClick:t[0]||(t[0]=()=>{})},{default:a(()=>[s.orgType==="1"?(c(),d(n,{key:"1",onClick:L=>Z(s)},{default:a(()=>[pe("添加店铺")]),_:2},1032,["onClick"])):h("",!0),s.orgType==="2"?(c(),d(n,{key:"2",onClick:L=>Y(s)},{default:a(()=>[ke]),_:2},1032,["onClick"])):h("",!0),s.orgType==="2"?(c(),d(n,{key:"3",onClick:L=>K.value=w},{default:a(()=>[xe]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)):h("",!0)]),default:a(()=>[A(M(he),{open:K.value===w,title:"确定要删除吗？","ok-text":"确定","cancel-text":"取消",placement:"rightTop",onConfirm:L=>H(s),onOpenChange:N},{default:a(()=>[U("span",null,le(re),1)]),_:2},1032,["open","onConfirm"])]),_:2},1024)]),_:1},8,["treeData","expandedKeys"]))],64)):(c(),d(ee,{key:1,description:"暂无数据"}))]),_:1},8,["spinning"]),A(_e,{rootTreeData:o.value,onRegister:M(Q),onSuccess:v},null,8,["rootTreeData","onRegister"])]),_:1})}}});const jo=fe(De,[["__scopeId","data-v-ed2dc5cd"]]);export{jo as default};
