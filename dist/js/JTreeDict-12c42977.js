var f=(m,v,u)=>new Promise((t,d)=>{var c=r=>{try{o(u.next(r))}catch(i){d(i)}},s=r=>{try{o(u.throw(r))}catch(i){d(i)}},o=r=>r.done?t(r.value):Promise.resolve(r.value).then(c,s);o((u=u.apply(m,v)).next())});import{d as b,f as C,w as T,a6 as x,ab as V,ae as R,u as g}from"./tinymce-vendor-3c2b3d6e.js";import{ar as P,ap as h}from"./jeecg-online-vendor-f57c6456.js";import{p,k as B}from"./index-37448b2d.js";import{V as H}from"./antd-vue-vendor-05bfa84d.js";import"./vxe-table-vendor-26792376.js";const F=b({__name:"JTreeDict",props:{value:p.string.def(""),field:p.string.def("id"),parentCode:p.string.def(""),async:p.bool.def(!1)},emits:["change","update:value"],setup(m,{emit:v}){const{prefixCls:u}=B("j-tree-dict"),t=m,d=P(),c=v,s=C([]),o=C(null);T(()=>t.value,()=>r(),{deep:!0,immediate:!0}),T(()=>t.parentCode,()=>i(),{deep:!0,immediate:!0});function r(){return f(this,null,function*(){if(!t.value||t.value=="0")o.value={value:null,label:null};else{let e={field:t.field,val:t.value},a=yield h.get({url:"/sys/category/loadOne",params:e});o.value={value:t.value,label:a.name}}})}function i(){return f(this,null,function*(){let e={async:t.async,pcode:t.parentCode},a=yield h.get({url:"/sys/category/loadTreeRoot",params:e});s.value=[...a],y(a)})}function D(e){return f(this,null,function*(){if(!t.async||e.dataRef.children)return Promise.resolve();let a=e.dataRef.key,l={pid:a},n=yield h.get({url:"/sys/category/loadTreeChildren",params:l});return y(n),_(a,n,s.value),s.value=[...s.value],Promise.resolve()})}function _(e,a,l){if(l&&l.length>0)for(let n of l)if(n.key==e){!a||a.length==0?n.leaf=!0:n.children=a;break}else _(e,a,n.children)}function y(e){let a=t.field=="code"?"code":"key";for(let l of e)l.value=l[a],l.isLeaf=l.leaf,l.children&&l.children.length>0&&y(l.children)}function k(e){w(e?e.value:""),o.value=e}function w(e){c("change",e),c("update:value",e)}return(e,a)=>(x(),V(g(H),R({class:g(u),value:o.value,treeData:s.value,loadData:D,allowClear:"",labelInValue:"",dropdownStyle:{maxHeight:"400px",overflow:"auto"},style:{width:"100%"}},g(d),{onChange:k}),null,16,["class","value","treeData"]))}});export{F as default};
