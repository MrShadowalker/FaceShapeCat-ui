var d=(x,b,f)=>new Promise((c,l)=>{var r=o=>{try{u(f.next(o))}catch(t){l(t)}},y=o=>{try{u(f.throw(o))}catch(t){l(t)}},u=o=>o.done?c(o.value):Promise.resolve(o.value).then(r,y);u((f=f.apply(x,b)).next())});import{d as Y,e as Z,f as i,w as G,n as g,Y as p,a6 as w,a7 as H,k as a,a9 as n,ab as h,ac as I,ad as J,Z as M,u as K,aj as Q,E as m,F as U,a4 as de,a5 as pe}from"./tinymce-vendor-3c2b3d6e.js";import{a as W}from"./index-563223fc.js";import{_ as X}from"./index-d4a67b72.js";import ee from"./DepartDataRuleDrawer-433257a5.js";import{c as te,e as ae,f as ne}from"./depart.api-76b2f38a.js";import{k as oe}from"./index-37448b2d.js";import{_ as se}from"./jeecg-online-vendor-f57c6456.js";import"./antd-vue-vendor-05bfa84d.js";import"./bem-a6e46c9e.js";import"./vxe-table-vendor-26792376.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";const le={class:"j-box-bottom-button offset-20",style:{"margin-top":"30px"}},re=Y({__name:"DepartRuleTab",props:{data:{type:Object,default:()=>({})}},setup(x){const{prefixCls:b}=oe("j-depart-form-content"),f=x,c=Z(()=>{var e;return(e=f.data)==null?void 0:e.id}),l=i(),r=i(!1),y=i([]),u=i([]),o=i([]),t=i([]),S=i([]),R=i(!0),[E,B]=W();T(),G(c,()=>j(),{immediate:!0});function T(){return d(this,null,function*(){try{r.value=!0;let{treeList:e}=yield te();y.value=e,yield g(),C(!0)}finally{r.value=!1}})}function j(){return d(this,null,function*(){if(c.value)try{r.value=!0;let e=yield ae({departId:c.value});t.value=e,S.value=[...e]}finally{r.value=!1}})}function L(){return d(this,null,function*(){try{r.value=!0,yield ne({departId:c.value,permissionIds:t.value.join(","),lastpermissionIds:S.value.join(",")}),yield T(),yield j()}finally{r.value=!1}})}function N(e){Array.isArray(e)?t.value=e:t.value=e.checked}function V(e){u.value=e}function F(e,{selectedNodes:s}){var _;if((_=s[0])!=null&&_.ruleFlag){let D=e[0];B.openDrawer(!0,{departId:c,functionId:D})}o.value=[]}function ie(e){return d(this,null,function*(){R.value=e,yield g(),t.value=l.value.getCheckedKeys()})}function C(e){return d(this,null,function*(){l.value.expandAll(e),yield g(),u.value=l.value.getExpandedKeys()})}function $(e){return d(this,null,function*(){l.value.checkAll(e),yield g(),t.value=l.value.getCheckedKeys()})}return(e,s)=>{const _=p("Icon"),D=p("a-empty"),k=p("a-menu-item"),P=p("a-menu"),A=p("a-button"),q=p("a-dropdown"),z=p("a-spin");return w(),H(U,null,[a(z,{spinning:r.value},{default:n(()=>[y.value.length>0?(w(),h(K(X),{key:0,ref_key:"basicTree",ref:l,class:"depart-rule-tree",checkable:"",treeData:y.value,checkedKeys:t.value,selectedKeys:o.value,expandedKeys:u.value,checkStrictly:R.value,style:{height:"500px",overflow:"auto"},onCheck:N,onExpand:V,onSelect:F},{title:n(({slotTitle:v,ruleFlag:O})=>[I("span",null,J(v),1),O?(w(),h(_,{key:0,icon:"ant-design:align-left-outlined",style:{"margin-left":"5px",color:"red"}})):M("",!0)]),_:1},8,["treeData","checkedKeys","selectedKeys","expandedKeys","checkStrictly"])):(w(),h(D,{key:1,description:"无可配置仓库权限"})),I("div",le,[I("div",{class:Q(["j-box-bottom-button-float",[`${K(b)}`]])},[a(q,{trigger:["click"],placement:"top"},{overlay:n(()=>[a(P,null,{default:n(()=>[a(k,{key:"3",onClick:s[0]||(s[0]=v=>$(!0))},{default:n(()=>[m("全部勾选")]),_:1}),a(k,{key:"4",onClick:s[1]||(s[1]=v=>$(!1))},{default:n(()=>[m("取消全选")]),_:1}),a(k,{key:"5",onClick:s[2]||(s[2]=v=>C(!0))},{default:n(()=>[m("展开所有")]),_:1}),a(k,{key:"6",onClick:s[3]||(s[3]=v=>C(!1))},{default:n(()=>[m("收起所有")]),_:1})]),_:1})]),default:n(()=>[a(A,{style:{float:"left"}},{default:n(()=>[m(" 树操作 "),a(_,{icon:"ant-design:up-outlined"})]),_:1})]),_:1}),a(A,{type:"primary",preIcon:"ant-design:save-filled",onClick:L},{default:n(()=>[m("保存")]),_:1})],2)])]),_:1},8,["spinning"]),a(ee,{onRegister:K(E)},null,8,["onRegister"])],64)}}});const De=se(re,[["__scopeId","data-v-d5f22197"]]);export{De as default};
