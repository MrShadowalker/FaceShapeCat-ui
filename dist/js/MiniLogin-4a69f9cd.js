var re=Object.defineProperty,ue=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var W=(t,i,n)=>i in t?re(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,Y=(t,i)=>{for(var n in i||(i={}))me.call(i,n)&&W(t,n,i[n]);if(z)for(var n of z(i))pe.call(i,n)&&W(t,n,i[n]);return t},J=(t,i)=>ue(t,de(i));var S=(t,i,n)=>new Promise((y,f)=>{var M=v=>{try{R(n.next(v))}catch(p){f(p)}},s=v=>{try{R(n.throw(v))}catch(p){f(p)}},R=v=>v.done?y(v.value):Promise.resolve(v.value).then(M,s);R((n=n.apply(t,i)).next())});import{d as ee,r as $,f as m,o as ge,Y as U,a6 as _,a7 as h,k as c,u as o,ac as e,q as D,A as F,aj as T,ad as L,ab as Q,a9 as b,a8 as X,E as _e,a4 as fe,a5 as ve,I as he}from"./tinymce-vendor-3c2b3d6e.js";import{u as ye,a2 as Ce,C as ke,B as xe,bj as be,b6 as we,bg as Ie,_ as Se}from"./jeecg-online-vendor-f57c6456.js";import{c as Te}from"./checkcode-5ec5fe8f.js";import Le from"./MiniForgotpad-8020604d.js";import Me from"./MiniRegister-45386ff0.js";import Re from"./MiniCodelogin-78854d36.js";import{a as Be}from"./jeecg_ad_text-6abee8dd.js";import{k as Ue,F as De,aG as Fe,aH as je}from"./index-37448b2d.js";import{bf as Ee}from"./antd-vue-vendor-05bfa84d.js";import"./vxe-table-vendor-26792376.js";import"./index-35591d01.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./ThirdModal-2b91df07.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./useThirdLogin-b70adaa5.js";const Z="/assets/jeecg_logo-e3b6644d.png",O=t=>(fe("data-v-5146217c"),t=t(),ve(),t),Ke={key:0,class:"aui-logo"},Ne=["src"],Pe={key:1,class:"aui-phone-logo"},$e=["src"],Oe={class:"aui-content"},qe={class:"aui-container"},Ae={class:"aui-form"},Ge={class:"aui-image"},He={class:"aui-image-text"},Ve=["src"],ze={class:"aui-formBox"},We={class:"aui-formWell"},Ye={class:"aui-flex aui-form-nav investment_title"},Je={class:"aui-form-box",style:{height:"180px"}},Qe={class:"aui-account"},Xe={class:"aui-inputClear"},Ze=O(()=>e("i",{class:"icon icon-code"},null,-1)),eo={class:"aui-inputClear"},oo=O(()=>e("i",{class:"icon icon-password"},null,-1)),so={class:"aui-inputClear"},no=O(()=>e("i",{class:"icon icon-code"},null,-1)),ao={class:"aui-code"},to=["src"],io=["src"],lo={class:"aui-flex"},co={class:"aui-flex-box"},ro={class:"aui-choice"},uo={style:{"margin-left":"5px"}},mo={class:"aui-account phone"},po={class:"aui-inputClear phoneClear"},go={class:"aui-inputClear"},_o={key:1,class:"aui-code"},fo={class:"aui-get-code code-shape"},vo={class:"aui-formButton"},ho={class:"aui-flex"},yo=ee({name:"login-mini"}),Co=ee(J(Y({},yo),{props:{sessionTimeout:{type:Boolean}},setup(t){const i=Ee({scriptUrl:"//at.alicdn.com/t/font_2316098_umqusozousr.js"}),{prefixCls:n}=Ue("mini-login"),{notification:y,createMessage:f}=ke(),M=ye(),{t:s}=xe(),v=Ce().getShowPicker,p=$({randCodeImage:"",requestCodeSuccess:!1,checkKey:null}),q=m("0"),C=m("accountLogin"),g=m("login"),r=$({inputCode:"",username:"",password:""}),u=$({mobile:"",smscode:""}),oe=m(),se=m(),A=m(),j=m(!0),k=m(60),B=m(null),G=m(),H=m(),w=m(!1),{getIsMobile:ne}=De();function I(){r.inputCode="",p.checkKey=1629428467008,be(p.checkKey).then(a=>{p.randCodeImage=a,p.requestCodeSuccess=!0})}function ae(a){C.value=a}function E(){return S(this,null,function*(){o(C)==="accountLogin"?te():ie()})}function te(){return S(this,null,function*(){if(!r.username){f.warn(s("sys.login.accountPlaceholder"));return}if(!r.password){f.warn(s("sys.login.passwordPlaceholder"));return}try{w.value=!0;const{userInfo:a}=yield M.login(he({password:r.password,username:r.username,captcha:r.inputCode,checkKey:p.checkKey,mode:"none"}));a&&y.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${a.realname}`,duration:3})}catch(a){y.error({message:s("sys.api.errorTip"),description:a.message||s("sys.login.networkExceptionMsg"),duration:3}),I()}finally{w.value=!1}})}function ie(){return S(this,null,function*(){if(!u.mobile){f.warn(s("sys.login.mobilePlaceholder"));return}if(!u.smscode){f.warn(s("sys.login.smsPlaceholder"));return}try{w.value=!0;const{userInfo:a}=yield M.phoneLogin({mobile:u.mobile,captcha:u.smscode,mode:"none"});a&&y.success({message:s("sys.login.loginSuccessTitle"),description:`${s("sys.login.loginSuccessDesc")}: ${a.realname}`,duration:3})}catch(a){y.error({message:s("sys.api.errorTip"),description:a.message||s("sys.login.networkExceptionMsg"),duration:3})}finally{w.value=!1}})}function le(){return S(this,null,function*(){if(!u.mobile){f.warn(s("sys.login.mobilePlaceholder"));return}(yield we({mobile:u.mobile,smsmode:Ie.FORGET_PASSWORD}))&&(o(B)||(k.value=60,j.value=!1,B.value=setInterval(()=>{o(k)>0&&o(k)<=60?k.value=k.value-1:(j.value=!0,clearInterval(o(B)),B.value=null)},1e3)))})}function ko(a){se.value.onThirdLogin(a)}function xo(){g.value="forgot",setTimeout(()=>{G.value.initForm()},300)}function K(){C.value="accountLogin",g.value="login"}function N(a){Object.assign(r,a),Object.assign(u,{mobile:"",smscode:""}),g.value="login",C.value="accountLogin",I()}function bo(){g.value="register",setTimeout(()=>{H.value.initForm()},300)}function wo(){g.value="codeLogin",setTimeout(()=>{A.value.initFrom()},300)}return ge(()=>{I()}),(a,l)=>{const x=U("a-input"),P=U("a-form-item"),V=U("a-form"),ce=U("a-button");return _(),h("div",{class:T([o(n),"login-background-img"])},[c(o(Fe),{class:"absolute top-4 right-4 enter-x xl:text-gray-600",showText:!1}),c(o(je),{class:"absolute top-3 right-7 enter-x"}),o(ne)?(_(),h("div",Pe,[e("img",{src:o(Z),alt:"jeecg"},null,8,$e)])):(_(),h("div",Ke,[e("div",null,[e("h3",null,[e("img",{src:o(Z),alt:"jeecg"},null,8,Ne)])])])),D(e("div",null,[e("div",Oe,[e("div",qe,[e("div",Ae,[e("div",Ge,[e("div",He,[e("img",{src:o(Be)},null,8,Ve)])]),e("div",ze,[e("div",We,[e("div",Ye,[e("div",{class:T(["aui-flex-box",C.value==="accountLogin"?"activeNav on":""]),onClick:l[0]||(l[0]=d=>ae("accountLogin"))},L(o(s)("sys.login.signInFormTitle")),3)]),e("div",Je,[C.value==="accountLogin"?(_(),Q(V,{key:0,ref_key:"loginRef",ref:oe,model:r,onKeyup:X(E,["enter","native"])},{default:b(()=>[e("div",Qe,[e("div",Xe,[Ze,c(P,null,{default:b(()=>[c(x,{class:"fix-auto-fill",placeholder:o(s)("sys.login.userName"),value:r.username,"onUpdate:value":l[1]||(l[1]=d=>r.username=d)},null,8,["placeholder","value"])]),_:1})]),e("div",eo,[oo,c(P,null,{default:b(()=>[c(x,{class:"fix-auto-fill",type:"password",placeholder:o(s)("sys.login.password"),value:r.password,"onUpdate:value":l[2]||(l[2]=d=>r.password=d)},null,8,["placeholder","value"])]),_:1})]),e("div",so,[no,c(P,null,{default:b(()=>[c(x,{class:"fix-auto-fill",type:"text",placeholder:o(s)("sys.login.inputCode"),value:r.inputCode,"onUpdate:value":l[3]||(l[3]=d=>r.inputCode=d)},null,8,["placeholder","value"])]),_:1}),e("div",ao,[p.requestCodeSuccess?(_(),h("img",{key:0,src:p.randCodeImage,onClick:I},null,8,to)):(_(),h("img",{key:1,style:{"margin-top":"2px","max-width":"initial"},src:o(Te),onClick:I},null,8,io))])]),e("div",lo,[e("div",co,[e("div",ro,[c(x,{class:"fix-auto-fill",type:"checkbox",value:q.value,"onUpdate:value":l[4]||(l[4]=d=>q.value=d)},null,8,["value"]),e("span",uo,L(o(s)("sys.login.rememberMe")),1)])])])])]),_:1},8,["model"])):(_(),Q(V,{key:1,ref:"phoneFormRef",model:u,onKeyup:X(E,["enter","native"])},{default:b(()=>[e("div",mo,[e("div",po,[c(x,{class:"fix-auto-fill",placeholder:o(s)("sys.login.mobile"),value:u.mobile,"onUpdate:value":l[5]||(l[5]=d=>u.mobile=d)},null,8,["placeholder","value"])]),e("div",go,[c(x,{class:"fix-auto-fill",maxlength:6,placeholder:o(s)("sys.login.smsCode"),value:u.smscode,"onUpdate:value":l[6]||(l[6]=d=>u.smscode=d)},null,8,["placeholder","value"]),j.value?(_(),h("div",{key:0,class:"aui-code",onClick:le},[e("a",null,L(o(s)("component.countdown.normalText")),1)])):(_(),h("div",_o,[e("span",fo,L(o(s)("component.countdown.sendText",[o(k.value)])),1)]))])])]),_:1},8,["model"]))]),e("div",vo,[e("div",ho,[c(ce,{loading:w.value,class:"aui-link-login",type:"primary",onClick:E},{default:b(()=>[_e(L(o(s)("sys.login.loginButton")),1)]),_:1},8,["loading"])])])])])])])])],512),[[F,g.value==="login"]]),D(e("div",{class:T(`${o(n)}-form`)},[c(Le,{ref_key:"forgotRef",ref:G,onGoBack:K,onSuccess:N},null,512)],2),[[F,g.value==="forgot"]]),D(e("div",{class:T(`${o(n)}-form`)},[c(Me,{ref_key:"registerRef",ref:H,onGoBack:K,onSuccess:N},null,512)],2),[[F,g.value==="register"]]),D(e("div",{class:T(`${o(n)}-form`)},[c(Re,{ref_key:"codeRef",ref:A,onGoBack:K,onSuccess:N},null,512)],2),[[F,g.value==="codeLogin"]])],2)}}}));const Go=Se(Co,[["__scopeId","data-v-5146217c"]]);export{Go as default};
