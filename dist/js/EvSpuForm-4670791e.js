var C=(U,x,b)=>new Promise((_,w)=>{var y=p=>{try{a(b.next(p))}catch(g){w(g)}},k=p=>{try{a(b.throw(p))}catch(g){w(g)}},a=p=>p.done?_(p.value):Promise.resolve(p.value).then(y,k);a((b=b.apply(U,x)).next())});import{d as Y,f as c,r as A,e as G,Y as m,a6 as H,ab as K,a9 as t,k as e,ae as f,u as v,n as Q}from"./tinymce-vendor-3c2b3d6e.js";import{C as W,_ as X}from"./jeecg-online-vendor-f57c6456.js";import{J as Z}from"./JImageUpload-1b0b2e46.js";import{a5 as $}from"./antd-vue-vendor-05bfa84d.js";import{duplicateValidate as S}from"./validator-a0d2ebc7.js";import"./vxe-table-vendor-26792376.js";import"./useFormItem-613b6d5d.js";import"./index-37448b2d.js";import"./user.api-367a7bce.js";const h=Y({__name:"EvSpuForm",props:{formDisabled:{type:Boolean,default:!1},formData:{type:Object,default:()=>{}},formBpm:{type:Boolean,default:!0}},emits:["register","ok"],setup(U,{expose:x,emit:b}){const _=U,w=c(),y=$.useForm,k=b,a=A({id:"",remark:"",name:"",code:"",imgPath:"",brandId:"",supplierIds:"",description:"",status:"",categoryIds:"",specificationNames:[]}),{createMessage:p}=W(),g=c({xs:{span:24},sm:{span:6}}),D=c({xs:{span:24},sm:{span:3}}),B=c({xs:{span:24},sm:{span:16}}),I=c({xs:{span:24},sm:{span:21}}),F=c(!1),P={name:[{required:!0,message:"请输入商品名称!"},{validator:q}],code:[{required:!0,message:"请输入商品编码!"},{validator:J}]},{resetFields:E,validate:O,validateInfos:r}=y(a,P,{immediate:!0}),n=G(()=>_.formBpm===!0?_.formData.disabled!==!1:_.formDisabled);function R(){N({status:"1"})}function N(u){Q(()=>C(this,null,function*(){if(E(),u.id){const l=yield listSpec({spuId:u.id,pageSize:9999});u.specificationNames=l.records}Object.assign(a,u)}))}function ee(){n.value||a.specificationNames.push({name:""})}function ae(u){a.specificationNames.splice(u,1)}function j(){return C(this,null,function*(){yield O(),F.value=!0;const u=c(!1);let l=a;l.id&&(u.value=!0),yield saveOrUpdate(l,u.value).then(o=>{o.success?(p.success(o.message),k("ok")):p.warning(o.message)}).finally(()=>{F.value=!1})})}function q(u,l){return C(this,null,function*(){return S("ev_spu","name",l,a.id||"")})}function J(u,l){return C(this,null,function*(){return S("ev_spu","code",l,a.id||"")})}return x({add:R,edit:N,submitForm:j}),(u,l)=>{const o=m("a-form-item"),d=m("a-col"),i=m("a-input"),M=m("a-divider"),V=m("a-textarea"),z=m("a-row"),L=m("a-form"),T=m("a-spin");return H(),K(T,{spinning:F.value},{default:t(()=>[e(L,{ref_key:"formRef",ref:w,class:"antd-modal-form",labelCol:g.value,wrapperCol:B.value},{default:t(()=>[e(z,null,{default:t(()=>[e(d,{span:24},{default:t(()=>[e(o,f({label:"商品图片"},v(r).imgPath,{labelCol:D.value,wrapperCol:I.value}),{default:t(()=>[e(Z,{value:a.imgPath,"onUpdate:value":l[0]||(l[0]=s=>a.imgPath=s),disabled:n.value},null,8,["value","disabled"])]),_:1},16,["labelCol","wrapperCol"])]),_:1}),e(d,{span:12},{default:t(()=>[e(o,f({label:"经销商"},v(r).name),{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[1]||(l[1]=s=>a.name=s),placeholder:"请输入经销商",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:12},{default:t(()=>[e(o,{label:"联系人"},{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[2]||(l[2]=s=>a.name=s),placeholder:"请输入联系人",disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(o,{label:"联系电话"},{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[3]||(l[3]=s=>a.name=s),placeholder:"请输入联系电话",disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(o,{label:"联系地址"},{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[4]||(l[4]=s=>a.name=s),placeholder:"请输入联系地址",disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(o,{label:"零售价"},{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[5]||(l[5]=s=>a.name=s),placeholder:"请输入零售价",disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(d,{span:12},{default:t(()=>[e(o,{label:"进价"},{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[6]||(l[6]=s=>a.name=s),placeholder:"请输入进价",disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(M),e(d,{span:12},{default:t(()=>[e(o,f({label:"商品名称"},v(r).name),{default:t(()=>[e(i,{value:a.name,"onUpdate:value":l[7]||(l[7]=s=>a.name=s),placeholder:"请输入商品名称",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:12},{default:t(()=>[e(o,f({label:"商品编码"},v(r).code),{default:t(()=>[e(i,{value:a.code,"onUpdate:value":l[8]||(l[8]=s=>a.code=s),placeholder:"请输入商品编码",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:12},{default:t(()=>[e(o,f({label:"商品种类"},v(r).code),{default:t(()=>[e(i,{value:a.code,"onUpdate:value":l[9]||(l[9]=s=>a.code=s),placeholder:"请输入商品种类",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:12},{default:t(()=>[e(o,f({label:"计量单位"},v(r).code),{default:t(()=>[e(i,{value:a.code,"onUpdate:value":l[10]||(l[10]=s=>a.code=s),placeholder:"请输入计量单位",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:12},{default:t(()=>[e(o,f({label:"规格型号"},v(r).code),{default:t(()=>[e(i,{value:a.code,"onUpdate:value":l[11]||(l[11]=s=>a.code=s),placeholder:"请输入规格型号",disabled:n.value},null,8,["value","disabled"])]),_:1},16)]),_:1}),e(d,{span:24},{default:t(()=>[e(o,f({label:"备注"},v(r).description,{labelCol:D.value,wrapperCol:I.value}),{default:t(()=>[e(V,{value:a.description,"onUpdate:value":l[12]||(l[12]=s=>a.description=s),disabled:n.value,rows:4},null,8,["value","disabled"])]),_:1},16,["labelCol","wrapperCol"])]),_:1})]),_:1})]),_:1},8,["labelCol","wrapperCol"])]),_:1},8,["spinning"])}}});const me=X(h,[["__scopeId","data-v-4bc66ccf"]]);export{me as default};
