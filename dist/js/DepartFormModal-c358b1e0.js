var N=Object.defineProperty;var M=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var C=(m,e,o)=>e in m?N(m,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):m[e]=o,O=(m,e)=>{for(var o in e||(e={}))j.call(e,o)&&C(m,o,e[o]);if(M)for(var o of M(e))k.call(e,o)&&C(m,o,e[o]);return m};var p=(m,e,o)=>new Promise((i,l)=>{var n=a=>{try{r(o.next(a))}catch(f){l(f)}},t=a=>{try{r(o.throw(a))}catch(f){l(f)}},r=a=>a.done?i(a.value):Promise.resolve(a.value).then(n,t);r((o=o.apply(m,e)).next())});import{u as s,f as g,n as D,b as _,w as x,d as U,c as v,e as K,a6 as L,ab as Y,a9 as $,k as I,ae as z}from"./tinymce-vendor-3c2b3d6e.js";import G from"./BasicForm-794b8128.js";import{e as lt,C as Z}from"./index-37448b2d.js";import{a as ft,d as dt}from"./FormItem-f39ffb12.js";import{aO as P,aZ as q,a_ as E,a$ as H,az as J,ay as R,aR as Q,aM as W}from"./jeecg-online-vendor-f57c6456.js";import{b as T}from"./componentMap-e2e33057.js";import"./ApiSelect-a616c270.js";import"./RadioButtonGroup-be3182af.js";import"./ApiTreeSelect-7ab64df4.js";import"./ApiRadioGroup-a1926fc5.js";import"./JAreaLinkage-60ec0830.js";import"./JSelectUser-023ffd97.js";import"./JSelectDept-26b8aabf.js";import"./JCodeEditor-6267f178.js";import"./JCategorySelect-c14709b3.js";import"./JSelectMultiple-02863d2e.js";import"./JPopup-69f13ff9.js";import"./JAreaSelect-6943c821.js";import"./JCheckbox-d99410ff.js";import"./JInput-32558d47.js";import"./JEllipsis-fabea416.js";import"./JDictSelectTag-74396fb4.js";import"./JTreeSelect-e4ac4320.js";import"./JSearchSelect-220da3dc.js";import"./JSelectUserByDept-72a30e16.js";import"./JEditor-72c28cfe.js";import"./JImageUpload-6faeac18.js";import{B as X}from"./index-64ecc8b2.js";import{b as tt}from"./depart.api-76b2f38a.js";import{u as et,o as S}from"./depart.data-bcb499f4.js";import"./antd-vue-vendor-05bfa84d.js";import"./FormAction-7a06d071.js";import"./formUtils-09c7de86.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./index-2ad3f236.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./JSelectPosition-8ff0e3eb.js";import"./PositionSelectModal-78464b4e.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-f6a2b32b.js";import"./useFormItem-613b6d5d.js";import"./JSelectRole-2ca1ea2e.js";import"./RoleSelectModal-32681bd6.js";import"./JMarkdownEditor-805e28d0.js";import"./index-2d7d6454.js";import"./JSelectInput-7c65dd59.js";import"./JSwitch-055650c4.js";import"./JTreeDict-12c42977.js";import"./JInputPop-9a107461.js";import"./EasyCronInput-bc71f27e.js";import"./EasyCronModal-623f3973.js";import"./EasyCronInner-7db9d00a.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./SecondUI-8499e1fa.js";import"./useTabMixin-15a02af3.js";import"./MinuteUI-458ae182.js";import"./HourUI-42b88661.js";import"./DayUI-2d2c9c82.js";import"./MonthUI-704b4fb2.js";import"./WeekUI-36891ade.js";import"./YearUI-5cc291be.js";import"./JUpload-037dc399.js";import"./index-76418551.js";import"./UploadItemActions-dbfa39da.js";import"./JAddInput-dec0792b.js";import"./index-3dc0c4fd.js";import"./JRangeNumber-21c95c35.js";import"./index-a68f2c34.js";import"./UserSelectModal-bbf30df5.js";import"./UserList-9509c9fd.js";import"./SelectedUserItem-6a7f0563.js";import"./UserListAndDepart-7270315e.js";import"./UserListAndRole-64eda5ed.js";import"./JRangeDate-e8736b63.js";import"./JRangeTime-687ea499.js";import"./RoleSelectInput-ad21fc36.js";import"./RoleSelectModal-0528d83f.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./data-9be677e2.js";import"./JSelectBiz-b887fca6.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./JSelectUser-6efbe652.js";import"./JImageUpload-1b0b2e46.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JPopup-8248ac78.js";import"./JTreeSelect-73cfd2cd.js";import"./JEllipsis-242e7bd0.js";import"./JUpload-70acb676.js";import"./JSearchSelect-4158b9a9.js";import"./index-aba90786.js";import"./areaDataUtil-bfcb9e4a.js";import"./UserSelectModal-e7ea3e82.js";import"./DeptSelectModal-bfb41b56.js";import"./JPopupOnlReportModal-e1cfaee8.js";import"./UserSelectByDepModal-4d6f7985.js";function rt(m,e){var l,n;return((l=s(m))==null?void 0:l.fieldMapToTime)&&(e=ot(m,e)),((n=s(m))==null?void 0:n.fieldMapToNumber)&&(e=it(m,e)),e}function ot(m,e){const o=s(m).fieldMapToTime;if(!o||!Array.isArray(o))return e;for(const[i,[l,n],t="YYYY-MM-DD"]of o){if(!i||!l||!n||!e[i])continue;let r=e[i];Array.isArray(r)||(r=r.split(","));const[a,f]=r;e[l]=P(a).format(t),e[n]=P(f).format(t),Reflect.deleteProperty(e,i)}return e}function it(m,e){const o=s(m).fieldMapToNumber;if(!o||!Array.isArray(o))return e;for(const[i,[l,n]]of o){if(!i||!l||!n||!e[i])continue;let t=e[i];typeof t=="string"&&(t=t.split(","));const[r,a]=t;e[l]=r,e[n]=a,Reflect.deleteProperty(e,i)}return e}function mt(m){const e=g(null),o=g(!1);T("OnlineSelectCascade",q),T("LinkTableCard",E),T("LinkTableSelect",H);function i(){return p(this,null,function*(){const t=s(e);return t||J("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),yield D(),t})}function l(t){R()&&_(()=>{e.value=null,o.value=null}),!(s(o)&&R()&&t===s(e))&&(e.value=t,o.value=!0,x(()=>m,()=>{m&&t.setProps(Q(m))},{immediate:!0,deep:!0}))}return[l,{scrollToField:(t,r)=>p(this,null,function*(){(yield i()).scrollToField(t,r)}),setProps:t=>p(this,null,function*(){(yield i()).setProps(t)}),updateSchema:t=>p(this,null,function*(){(yield i()).updateSchema(t)}),resetSchema:t=>p(this,null,function*(){(yield i()).resetSchema(t)}),clearValidate:t=>p(this,null,function*(){(yield i()).clearValidate(t)}),resetFields:()=>p(this,null,function*(){i().then(t=>p(this,null,function*(){yield t.resetFields()}))}),removeSchemaByFiled:t=>p(this,null,function*(){var r;(r=s(e))==null||r.removeSchemaByFiled(t)}),getFieldsValue:()=>{var r;let t=(r=s(e))==null?void 0:r.getFieldsValue();return t&&Object.keys(t).map(a=>{t[a]instanceof Array&&(typeof(t[a][0]||"")=="object"||(t[a]=t[a].join(",")))}),t},setFieldsValue:t=>p(this,null,function*(){(yield i()).setFieldsValue(t)}),appendSchemaByField:(t,r,a)=>p(this,null,function*(){(yield i()).appendSchemaByField(t,r,a)}),submit:()=>p(this,null,function*(){return(yield i()).submit()}),validate:t=>p(this,null,function*(){const r=yield i();let a=m||r.getProps;return r.validate(t).then(d=>{for(let u in d)d[u]instanceof Array&&W(a,u)==="string"&&(d[u]=d[u].join(","));return rt(a,d)})}),validateFields:(t,r)=>p(this,null,function*(){return(yield i()).validateFields(t,r)})}]}const br=U({__name:"DepartFormModal",props:{rootTreeData:{type:Array,default:()=>[]}},emits:["success","register"],setup(m,{emit:e}){const o=e,i=m,l=v("prefixCls"),n=g(!1),t=g({}),r=K(()=>n.value?"编辑":"新增"),[a,{resetFields:f,setFieldsValue:d,validate:u,updateSchema:b}]=mt({schemas:et().basicFormSchema,showActionButtonGroup:!1}),[V,{setModalProps:w,closeModal:B}]=Z(c=>p(this,null,function*(){yield f(),n.value=s(c==null?void 0:c.isUpdate);let h=s(c==null?void 0:c.isChild),F=h?S.child:S.root;b([{field:"parentId",show:h,componentProps:{disabled:h,treeData:i.rootTreeData}},{field:"orgCode",show:!1},{field:"orgCategory",componentProps:{options:F}}]);let y=s(c==null?void 0:c.record);typeof y!="object"&&(y={}),y=Object.assign({departOrder:0,orgCategory:F[0].value},y),t.value=y,yield d(O({},y))}));function A(){return p(this,null,function*(){try{w({confirmLoading:!0});let c=yield u();yield tt(c,n.value),B(),o("success")}finally{w({confirmLoading:!1})}})}return(c,h)=>(L(),Y(s(X),z({title:r.value,width:800},c.$attrs,{onOk:A,onRegister:s(V)}),{default:$(()=>[I(s(G),{onRegister:s(a)},null,8,["onRegister"])]),_:1},16,["title","onRegister"]))}});export{br as default};
