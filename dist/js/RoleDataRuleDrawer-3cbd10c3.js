var h=(w,v,c)=>new Promise((g,n)=>{var u=a=>{try{e(c.next(a))}catch(_){n(_)}},i=a=>{try{e(c.throw(a))}catch(_){n(_)}},e=a=>a.done?g(a.value):Promise.resolve(a.value).then(u,i);e((c=c.apply(w,v)).next())});import{d as P,f,Y as s,a6 as p,ab as k,a9 as t,k as l,a7 as b,aa as j,E as I,ad as z,F as A,ac as D,ae as K,u as o}from"./tinymce-vendor-3c2b3d6e.js";import{u as O,B as S}from"./index-563223fc.js";import{C as T}from"./jeecg-online-vendor-f57c6456.js";import{q as U,h as Y}from"./role.api-90341a61.js";import"./antd-vue-vendor-05bfa84d.js";import"./index-37448b2d.js";import"./vxe-table-vendor-26792376.js";const $={style:{width:"100%","margin-top":"15px"}},G={key:1},H=D("h3",null,"无配置信息!",-1),J=[H],se=P({__name:"RoleDataRuleDrawer",emits:["success","register"],setup(w,{emit:v}){const c=v,{createMessage:g}=T(),n=f(""),u=f(""),i=f([]),e=f([]),[a,{setDrawerProps:_,closeDrawer:R}]=O(d=>h(this,null,function*(){yield x(),_({confirmLoading:!1}),n.value=d.functionId,u.value=d.roleId;const r=yield U({functionId:o(n),roleId:o(u)});r.success&&(i.value=r.result.datarule,r.result.drChecked&&(e.value=r.result.drChecked.split(",")))}));function x(){n.value="",u.value="",i.value=[],e.value=[]}function C(){return h(this,null,function*(){(!o(e)||o(e).length==0)&&g.warning("请注意，现未勾选任何数据权限!");let d={permissionId:o(n),roleId:o(u),dataRuleIds:o(e).join(",")};yield Y(d),R(),c("success")})}return(d,r)=>{const B=s("a-checkbox"),y=s("a-col"),N=s("Icon"),F=s("a-button"),L=s("a-row"),V=s("a-checkbox-group"),q=s("a-tab-pane"),E=s("a-tabs");return p(),k(o(S),K(d.$attrs,{onRegister:o(a),title:"数据规则配置",width:"450px",destroyOnClose:""}),{default:t(()=>[l(E,{defaultActiveKey:"1"},{default:t(()=>[l(q,{tab:"数据规则",key:"1"},{default:t(()=>[i.value.length>0?(p(),k(V,{key:0,value:e.value,"onUpdate:value":r[0]||(r[0]=m=>e.value=m)},{default:t(()=>[l(L,null,{default:t(()=>[(p(!0),b(A,null,j(i.value,(m,M)=>(p(),k(y,{span:24,key:"dr"+M},{default:t(()=>[l(B,{value:m.id},{default:t(()=>[I(z(m.ruleName),1)]),_:2},1032,["value"])]),_:2},1024))),128)),l(y,{span:24},{default:t(()=>[D("div",$,[l(F,{onClick:C,type:"primary",size:"small"},{default:t(()=>[l(N,{icon:"ant-design:save-outlined"}),I("点击保存")]),_:1})])]),_:1})]),_:1})]),_:1},8,["value"])):(p(),b("div",G,J))]),_:1})]),_:1})]),_:1},16,["onRegister"])}}});export{se as default};
