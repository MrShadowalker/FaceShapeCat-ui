var M=Object.defineProperty;var b=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var v=(e,s,o)=>s in e?M(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,x=(e,s)=>{for(var o in s||(s={}))S.call(s,o)&&v(e,o,s[o]);if(b)for(var o of b(s))k.call(s,o)&&v(e,o,s[o]);return e};var C=(e,s,o)=>new Promise((i,n)=>{var d=r=>{try{y(o.next(r))}catch(m){n(m)}},p=r=>{try{y(o.throw(r))}catch(m){n(m)}},y=r=>r.done?i(r.value):Promise.resolve(r.value).then(d,p);y((o=o.apply(e,s)).next())});import{d as I,f as g,e as U,u as a,a6 as R,ab as O,a9 as D,k as F,ae as E}from"./tinymce-vendor-3c2b3d6e.js";import{B as j}from"./index-64ecc8b2.js";import"./index-09260ce4.js";import{ap as c}from"./jeecg-online-vendor-f57c6456.js";import{M as H}from"./antd-vue-vendor-05bfa84d.js";import{u as X,B as K}from"./useForm-df7d93c5.js";import{C as N}from"./index-37448b2d.js";const te=[{title:"分类名称",dataIndex:"name",width:350,align:"left"},{title:"分类编码",dataIndex:"code"}],se=[{label:"名称",field:"name",component:"Input",colProps:{span:6}},{label:"编码",field:"code",component:"Input",colProps:{span:6}}],V=[{label:"",field:"id",component:"Input",show:!1},{label:"父级节点",field:"pid",component:"TreeSelect",componentProps:{fieldNames:{value:"key"},dropdownStyle:{maxHeight:"50vh"},getPopupContainer:()=>document.body},show:({values:e})=>e.pid!=="0",dynamicDisabled:({values:e})=>!!e.id},{label:"分类名称",field:"name",required:!0,component:"Input"}];const oe="/sys/category/exportXls",ae="/sys/category/importExcel",re=e=>c.get({url:"/sys/category/rootList",params:e}),le=(e,s)=>c.delete({url:"/sys/category/delete",params:e},{joinParamsToUrl:!0}).then(()=>{s()}),ne=(e,s)=>{H.confirm({title:"确认删除",content:"是否删除选中数据",okText:"确认",cancelText:"取消",onOk:()=>c.delete({url:"/sys/category/deleteBatch",data:e},{joinParamsToUrl:!0}).then(()=>{s()})})},q=(e,s)=>{let o=s?"/sys/category/edit":"/sys/category/add";return c.post({url:o,params:e})},z=e=>c.get({url:"/sys/category/loadTreeRoot",params:e}),ce=e=>c.get({url:"/sys/category/childList",params:e}),ie=e=>c.get({url:"/sys/category/getChildListBatch",params:e},{isTransformResponse:!1}),G=I({__name:"CategoryModal",emits:["register","success"],setup(e,{emit:s}){const o=s,i=g(!0),n=g([]),d=g([]),p=g(!1),[y,{resetFields:r,setFieldsValue:m,validate:B,updateSchema:w}]=X({schemas:V,showActionButtonGroup:!1,labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}}),[L,{setModalProps:f,closeModal:_}]=N(t=>C(this,null,function*(){yield r(),n.value=[],f({confirmLoading:!1,minHeight:80}),i.value=!!(t!=null&&t.isUpdate),p.value=!(t!=null&&t.isUpdate)&&t.record&&t.record.id,t!=null&&t.record&&(yield m(x({},t.record))),d.value=yield z({async:!1,pcode:""}),w({field:"pid",componentProps:{treeData:d}})})),T=U(()=>a(i)?"编辑字典":"新增字典");function h(t,l){if(t&&l&&l.length>0)for(let u=0;u<l.length;u++)l[u].key==t&&a(n).indexOf(t)<0?(n.value.push(l[u].key),h(l[u].parentId,a(d))):h(t,l[u].children)}function P(){return C(this,null,function*(){try{let t=yield B();f({confirmLoading:!0}),yield q(t,i.value),_(),yield h(t.pid,a(d)),o("success",{isUpdate:a(i),isSubAdd:a(p),values:x({},t),expandedArr:a(n).reverse()})}finally{f({confirmLoading:!1})}})}return(t,l)=>(R(),O(a(j),E(t.$attrs,{onRegister:a(L),destroyOnClose:"",title:T.value,onOk:P}),{default:D(()=>[F(a(K),{onRegister:a(y)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}}),de=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{de as C,G as _,ae as a,ne as b,te as c,le as d,ie as e,ce as f,oe as g,re as l,se as s};
