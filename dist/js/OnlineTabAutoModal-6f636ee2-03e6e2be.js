import{d as X,f as x,w as $,Y as d,a6 as p,ab as C,ae as ee,aq as te,a9 as m,a7 as M,F as _,aa as L,E as g,ad as S,Z as oe,k as v,ac as y}from"./tinymce-vendor-3c2b3d6e.js";import{B as ae}from"./index-64ecc8b2.js";import ie from"./OnlineTabForm-512d3951-86104182.js";import{z as me}from"./useExtendComponent-325fe3f1-007b9393.js";import{t as re}from"./CommentPanel-62548135.js";import{e as ne}from"./constant-754f1a9d-eadfd1e1.js";import{bs as le}from"./jeecg-online-vendor-f57c6456.js";import"./index-09260ce4.js";import"./antd-vue-vendor-05bfa84d.js";import"./index-37448b2d.js";import"./useCustomHook-acb00837-32b1f38e.js";import"./componentMap-e2e33057.js";import"./index-8e09cdad.js";import"./user.api-367a7bce.js";import"./customExpression-b2f1ff9b.js";import"./index-0f0d0317.js";import"./useListPage-66651993.js";import"./index-76418551.js";import"./LinkTableListPiece-8499a318-01ebb291.js";import"./OnlineSelectCascade-4265c95d-4cbe6ffe.js";import"./JModalTip-33c7dc44-1741a3e9.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./useForm-df7d93c5.js";import"./formUtils-09c7de86.js";import"./data-9be677e2.js";import"./JUpload-70acb676.js";import"./BasicTable-400bb95b.js";import"./injectionKey-69710956.js";import"./index-2ad3f236.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./useFormItem-613b6d5d.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./index-2d7d6454.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JPopup-8248ac78.js";import"./JEllipsis-242e7bd0.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JTreeSelect-73cfd2cd.js";import"./JSearchSelect-4158b9a9.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JImageUpload-1b0b2e46.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";var de=(e,a,i)=>new Promise((s,l)=>{var b=t=>{try{r(i.next(t))}catch(n){l(n)}},c=t=>{try{r(i.throw(t))}catch(n){l(n)}},r=t=>t.done?s(t.value):Promise.resolve(t.value).then(b,c);r((i=i.apply(e,a)).next())});const pe=X({name:"OnlineTabAutoModal",props:{id:{type:String,default:""}},components:{BasicModal:ae,OnlineForm:ie,CommentPanel:re},emits:["success","register","formConfig"],setup(e,{emit:a}){const i=x(),s=x([]),l=x("-1");function b(){i.value&&i.value.reload()}const{title:c,modalWidth:r,registerModal:t,closeModal:n,cgButtonList:T,handleCgButtonClick:I,disableSubmit:o,handleSubmit:f,submitLoading:P,handleCancel:V,handleFormConfig:E,onlineFormCompRef:A,formTemplate:D,isTreeForm:O,pidFieldName:W,renderSuccess:j,formRendered:z,tableName:q,formDataId:H,enableComment:U,onCloseEvent:B,themeTemplate:Y}=me(!1,{emit:a},b);function Z(u){a("success",u),n(),B(),F()}$(()=>e.id,G,{immediate:!0});function G(){return de(this,null,function*(){z.value=!1,e.id&&(yield E(e.id,{},u=>{const R=[],k=[],{head:w,schema:K}=u,{properties:Q}=K;R.push({tableName:w.tableName,tableTxt:w.tableTxt}),Object.entries(Q).forEach(([N,h])=>{h.view=="tab"&&k.push({tableName:N,tableTxt:h.describe})}),k.sort((N,h)=>N.order-h.order),s.value=[...R,...k]}))})}const J=u=>String(u-1),F=()=>{setTimeout(()=>{l.value="-1"},500)};return{title:c,onlineFormCompRef:A,renderSuccess:j,registerModal:t,handleSubmit:f,handleSuccess:Z,handleCancel:V,modalWidth:r,formTemplate:D,disableSubmit:o,cgButtonList:T,handleCgButtonClick:I,isTreeForm:O,pidFieldName:W,submitLoading:P,tableName:q,formDataId:H,enableComment:U,commentPanelRef:i,onCloseEvent:B,themeTemplate:Y,tabNav:s,tabValue:J,tabIndex:l,TAB:ne,restTabIndex:F}}}),se={class:"titleArea"},ce={class:"title"},ue={class:"right"};function be(e,a,i,s,l,b){const c=d("a-radio-button"),r=d("a-radio-group"),t=d("a-button"),n=d("online-form"),T=d("comment-panel"),I=d("BasicModal");return p(),C(I,ee({title:e.title,onCancel:a[2]||(a[2]=()=>{e.onCloseEvent(),e.restTabIndex()}),enableComment:e.enableComment,width:e.modalWidth},e.$attrs,{maxHeight:600,onRegister:e.registerModal,wrapClassName:"jeecg-online-modal",onOk:e.handleSubmit}),te({footer:m(()=>[(p(!0),M(_,null,L(e.cgButtonList,o=>(p(),C(t,{key:o.id,type:"primary",onClick:f=>e.handleCgButtonClick(o.optType,o.buttonCode),preIcon:o.buttonIcon?"ant-design:"+o.buttonIcon:""},{default:m(()=>[g(S(o.buttonName),1)]),_:2},1032,["onClick","preIcon"]))),128)),e.disableSubmit?oe("",!0):(p(),C(t,{key:"submit",type:"primary",onClick:e.handleSubmit,loading:e.submitLoading},{default:m(()=>[g("确定")]),_:1},8,["onClick","loading"])),v(t,{key:"back",onClick:a[1]||(a[1]=()=>{e.handleCancel(),e.restTabIndex()})},{default:m(()=>[g("关闭")]),_:1})]),comment:m(()=>[v(T,{ref:"commentPanelRef",tableName:e.tableName,dataId:e.formDataId},null,8,["tableName","dataId"])]),default:m(()=>[v(n,{ref:"onlineFormCompRef",id:e.id,disabled:e.disableSubmit,"form-template":e.formTemplate,isTree:e.isTreeForm,pidField:e.pidFieldName,themeTemplate:e.themeTemplate,tabIndex:e.tabIndex,onRendered:e.renderSuccess,onSuccess:e.handleSuccess},null,8,["id","disabled","form-template","isTree","pidField","themeTemplate","tabIndex","onRendered","onSuccess"])]),_:2},[e.themeTemplate===e.TAB?{name:"title",fn:m(()=>[y("div",se,[y("div",ce,S(e.title),1),y("div",ue,[v(r,{value:e.tabIndex,"onUpdate:value":a[0]||(a[0]=o=>e.tabIndex=o)},{default:m(()=>[(p(!0),M(_,null,L(e.tabNav,(o,f)=>(p(),C(c,{value:e.tabValue(f),key:o.tableName},{default:m(()=>[g(S(o.tableTxt),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])])])]),key:"0"}:void 0]),1040,["title","enableComment","width","onRegister","onOk"])}const wt=le(pe,[["render",be],["__scopeId","data-v-1b8f2c75"]]);export{wt as default};
