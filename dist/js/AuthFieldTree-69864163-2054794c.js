import{d as T,f as p,e as V,w as H,u as R,Y as f,a6 as x,a7 as w,ab as D,F as q,ac as J,k as d,a9 as v,E as k}from"./tinymce-vendor-3c2b3d6e.js";import{C as Y,bs as $}from"./jeecg-online-vendor-f57c6456.js";import{f as j,A as G,B as L}from"./auth.api-d3a6c4b3-afe9bb9e.js";import{bv as Q,bw as W,bx as X,by as Z,av as ee}from"./antd-vue-vendor-05bfa84d.js";import"./vxe-table-vendor-26792376.js";var E=(e,h,c)=>new Promise((C,m)=>{var s=o=>{try{n(c.next(o))}catch(r){m(r)}},a=o=>{try{n(c.throw(o))}catch(r){m(r)}},n=o=>o.done?C(o.value):Promise.resolve(o.value).then(s,a);n((c=c.apply(e,h)).next())});const le=T({name:"AuthFieldTree",components:{DownCircleOutlined:Q,HomeOutlined:W,UpCircleOutlined:X,UndoOutlined:Z,CheckOutlined:ee},props:{cgformId:{type:String,required:!0}},setup(e){const{createMessage:h}=Y(),c=p(""),C=p(1),m=p(!0),s=p([]),a=p([]),n=p([]),o=p([]),r=p(""),O=V(()=>!c.value);H(()=>e.cgformId,y,{immediate:!0});function y(){return E(this,null,function*(){if(!e.cgformId)return;let l=yield j(e.cgformId,C.value),t=[],i=[];l.forEach(u=>{i.includes(u.code)||(i.push(u.code),t.push({key:u.code,title:u.title}))});for(let u of t){let K=[];for(let I of l)if(u.key===I.code){let F=b(I);K.push({key:I.id,title:F})}u.children=K}o.value=t,s.value=[...i],n.value=i})}function b(l){let t="";return l.page==3?t+="列表":l.page==5&&(t+="表单"),l.control==3?t+="可编辑":l.control==5&&(t+="可见"),t}function g(l,t){return E(this,null,function*(){c.value=l,r.value=t,a.value=[],yield y();let i=yield G({roleId:l,cgformId:e.cgformId,type:C.value,authMode:t});a.value=i.map(u=>u.authId)})}function S(){c.value="",y()}function _(){y(),g(c.value,r.value)}function A(){return E(this,null,function*(){let l=a.value.filter(t=>n.value.indexOf(t)<0);yield L(c.value,e.cgformId,{authId:JSON.stringify(l),authMode:r.value}),h.success("保存成功")})}function U(){s.value=[...n.value]}function z(){s.value=[]}function B(l){s.value=l,m.value=!1}function P(){c.value="",a.value=[]}function M(){a.value=[]}function N(){const l=function(t){for(let i of t)a.value.push(i.key),i.children&&i.children.length>0&&l.call(null,i.children)};a.value=[],l.call(null,R(o))}return{loadChecked:g,clear:P,expandedKeys:s,autoExpandParent:m,checkedKeys:a,treeData:o,disabled:O,onSave:A,onExpand:B,clearChecked:S,onCloseAll:z,onExpandAll:U,onRefresh:_,onClearSelected:M,onSelectAll:N}}}),te={class:"onl-auth-tree-btns"};function ne(e,h,c,C,m,s){const a=f("a-empty"),n=f("a-button"),o=f("DownCircleOutlined"),r=f("UpCircleOutlined"),O=f("CheckOutlined"),y=f("UndoOutlined"),b=f("a-tree");return x(),w("div",null,[e.disabled?(x(),D(a,{key:0,description:"请先选中左侧角色/部门/用户"})):e.treeData.length===0?(x(),D(a,{key:1,description:"无权限信息"})):(x(),w(q,{key:2},[J("div",te,[d(n,{onClick:e.onRefresh,size:"small",type:"primary",preIcon:"ant-design:redo",ghost:""},{default:v(()=>[k("刷新")]),_:1},8,["onClick"]),d(n,{onClick:e.onExpandAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(o),k("展开")]),_:1},8,["onClick"]),d(n,{onClick:e.onCloseAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(r),k("折叠")]),_:1},8,["onClick"]),d(n,{onClick:e.onSave,size:"small",type:"primary",preIcon:"ant-design:save",ghost:""},{default:v(()=>[k("保存")]),_:1},8,["onClick"]),d(n,{onClick:e.onSelectAll,size:"small",type:"primary",ghost:""},{default:v(()=>[d(O),k("全选")]),_:1},8,["onClick"]),d(n,{onClick:e.onClearSelected,size:"small",type:"primary",ghost:""},{default:v(()=>[d(y),k("重置")]),_:1},8,["onClick"])]),d(b,{checkable:"",checkedKeys:e.checkedKeys,"onUpdate:checkedKeys":h[0]||(h[0]=g=>e.checkedKeys=g),expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,treeData:e.treeData,onExpand:e.onExpand},null,8,["checkedKeys","expandedKeys","autoExpandParent","treeData","onExpand"])],64))])}const re=$(le,[["render",ne],["__scopeId","data-v-e6dabb1d"]]);export{re as default};
