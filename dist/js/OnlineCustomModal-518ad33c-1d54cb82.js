import{d as G,f as n,n as P,w as W,r as Y,a0 as z,a3 as J,Y as v,a6 as F,ab as b,ae as Q,a9 as c,k,E as T,ag as X}from"./tinymce-vendor-3c2b3d6e.js";import{B as Z}from"./index-64ecc8b2.js";import{D as B}from"./useExtendComponent-325fe3f1-007b9393.js";import{ap as oo,bw as to,bs as eo}from"./jeecg-online-vendor-f57c6456.js";import ro from"./OnlineForm-1fa2d893-7d37908f.js";import"./componentMap-e2e33057.js";import{C as io}from"./index-37448b2d.js";import"./antd-vue-vendor-05bfa84d.js";import"./index-09260ce4.js";import"./constant-754f1a9d-eadfd1e1.js";import"./index-8e09cdad.js";import"./user.api-367a7bce.js";import"./customExpression-b2f1ff9b.js";import"./index-0f0d0317.js";import"./useListPage-66651993.js";import"./index-76418551.js";import"./LinkTableListPiece-8499a318-01ebb291.js";import"./OnlineSelectCascade-4265c95d-4cbe6ffe.js";import"./JModalTip-33c7dc44-1741a3e9.js";import"./useCustomHook-acb00837-32b1f38e.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";import"./data-9be677e2.js";import"./JUpload-70acb676.js";import"./useForm-df7d93c5.js";import"./formUtils-09c7de86.js";import"./BasicTable-400bb95b.js";import"./injectionKey-69710956.js";import"./index-2ad3f236.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./useFormItem-613b6d5d.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./index-2d7d6454.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JPopup-8248ac78.js";import"./JEllipsis-242e7bd0.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JTreeSelect-73cfd2cd.js";import"./JSearchSelect-4158b9a9.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JImageUpload-1b0b2e46.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";var d=(o,f,i)=>new Promise((m,p)=>{var u=e=>{try{a(i.next(e))}catch(l){p(l)}},s=e=>{try{a(i.throw(e))}catch(l){p(l)}},a=e=>e.done?m(e.value):Promise.resolve(e.value).then(u,s);a((i=i.apply(o,f)).next())});const no={code:"",title:"自定义弹框",width:600,row:{},hide:[],show:[],requestUrl:"",tableType:"",foreignKeys:"",formComponent:""},mo=G({name:"OnlineCustomModal",components:{OnlineForm:ro,BasicModal:Z},setup(o,{emit:f}){const i=n(),m=n(""),p=n("自定义弹框"),u=n(600);let s=[],a=[],e="",l={};const x={loadFormItems:"/online/cgform/api/getFormItem/",optPre:"/online/cgform/api/form/"},I={position:"relative"},L=n(!1),w=n(!1);function N(){w.value=!0}const h=n(!0),[j,{setModalProps:q,closeModal:S}]=io(t=>d(this,null,function*(){q({confirmLoading:!1}),D(t),yield P(()=>d(this,null,function*(){t.formComponent?K(t.formComponent):yield $()}))}));function D(t){let r=Object.assign({},no,t);m.value=r.code,p.value=r.title,u.value=r.width,s=r.hide||[],a=r.show||[],e=V(r.requestUrl),l=r.row}function V(t){return t||x.optPre+m.value}const g=n(!1);function _(){g.value=!0,h.value===!0?i.value.handleSubmit():M.value.handleSubmit(),setTimeout(()=>{g.value=!0},3500)}function E(){S()}function U(t){f("success",t),S()}function $(){return d(this,null,function*(){h.value=!0,yield B(w),i.value.handleCustomFormSh(a,s),i.value.handleCustomFormEdit(l,e)})}const R=n(1);W(m,A,{immediate:!0});function A(){return d(this,null,function*(){if(w.value=!1,!m.value)return;let t=yield H(),r=t.head.formTemplate;R.value=r?Number(r):1,P(()=>d(this,null,function*(){(yield B(i)).createRootProperties(t)}))})}function H(){let t=`/online/cgform/api/getFormItem/${m.value}`;return new Promise((r,O)=>{oo.get({url:t},{isTransformResponse:!1}).then(y=>{y.success?r(y.result):O(y.message)}).catch(()=>{O()})})}const M=n(),C=Y({url:"",is:"",row:{}});function K(t){h.value=!1,C.url=e,C.row=l,C.is=z(J(()=>to(t)))}return{registerModal:j,title:p,width:u,modalStyle:I,handleSubmit:_,handleCancel:E,id:m,onlineFormCompRef:i,formTemplate:R,renderSuccess:N,customFormRef:M,customFormComponent:C,open,isOnlineForm:h,confirmLoading:L,submitLoading:g,handleSuccess:U}}});function lo(o,f,i,m,p,u){const s=v("a-button"),a=v("online-form"),e=v("a-spin"),l=v("BasicModal");return F(),b(l,Q({title:o.title,width:o.width},o.$attrs,{style:o.modalStyle,onRegister:o.registerModal,wrapClassName:"jeecg-online-modal2",onOk:o.handleSubmit}),{footer:c(()=>[k(s,{key:"submit",type:"primary",onClick:o.handleSubmit},{default:c(()=>[T("确定")]),_:1},8,["onClick"]),k(s,{key:"back",onClick:o.handleCancel},{default:c(()=>[T("关闭")]),_:1},8,["onClick"])]),default:c(()=>[k(e,{spinning:o.confirmLoading},{default:c(()=>[o.isOnlineForm?(F(),b(a,{key:0,ref:"onlineFormCompRef",id:o.id,"form-template":o.formTemplate,onRendered:o.renderSuccess,onSuccess:o.handleSuccess,modalClass:"jeecg-online-modal2"},null,8,["id","form-template","onRendered","onSuccess"])):(F(),b(X(o.customFormComponent.is),{key:1,ref:"customFormRef",url:o.customFormComponent.url,row:o.customFormComponent.row,onClose:o.handleSuccess},null,40,["url","row","onClose"]))]),_:1},8,["spinning"])]),_:1},16,["title","width","style","onRegister","onOk"])}const kt=eo(mo,[["render",lo]]);export{kt as default};
