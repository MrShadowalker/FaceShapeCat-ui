var S=(f,p,o)=>new Promise((l,_)=>{var g=a=>{try{r(o.next(a))}catch(d){_(d)}},n=a=>{try{r(o.throw(a))}catch(d){_(d)}},r=a=>a.done?l(a.value):Promise.resolve(a.value).then(g,n);r((o=o.apply(f,p)).next())});import{B as b}from"./index-64ecc8b2.js";import{m as T,au as D}from"./antd-vue-vendor-05bfa84d.js";import N from"./SelectedUserItem-6a7f0563.js";import{ap as F,_ as V}from"./jeecg-online-vendor-f57c6456.js";import{f as B,e as x,w as j,I as L,a4 as ae,a5 as se,Y as m,a6 as v,ab as M,a9 as w,ac as u,k as C,a7 as I,F as R,aa as U,ad as z}from"./tinymce-vendor-3c2b3d6e.js";import{C as E}from"./index-37448b2d.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./vxe-table-vendor-26792376.js";const H={name:"RoleSelectModal",components:{BasicModal:b,SearchOutlined:T,CloseOutlined:D,SelectedUserItem:N},props:{multi:{type:Boolean,default:!0},getContainer:{type:Function,default:null},title:{type:String,default:""},type:{type:String,default:"sys_role"},appId:{type:String,default:""}},emits:["selected","register"],setup(f,{emit:p}){const o=B(""),l=x(()=>{let e=a.value;return!e||e.length==0?[]:e.map(t=>t.id)});j(()=>f.appId,e=>S(this,null,function*(){e&&(yield y())}),{immediate:!0});const[_]=E(e=>{let t=n.value;if(!(!t||t.length==0)){let i=e.list||[];for(let s of t)i.indexOf(s.id)>=0?s.checked=!0:s.checked=!1}});function g(){let e=L(l.value);p("selected",e,L(a.value))}const n=B([]),r=x(()=>{let e=n.value;if(!e||e.length==0)return[];let t=o.value;return t?e.filter(i=>i.name.indexOf(t)>=0):e}),a=x(()=>{let e=n.value;return!e||e.length==0?[]:e.filter(t=>t.checked)});function d(e){let t=n.value;if(!t||t.length==0)return;let i=t.filter(s=>s.id==e);i[0].checked=!1}function y(){return S(this,null,function*(){let e={pageNo:1,pageSize:200,column:"createTime",order:"desc"};const t="/sys/role/listByTenant",i=yield F.get({url:t,params:e},{isTransformResponse:!1});if(i.success){const{records:s}=i.result;let O=[];if(s&&s.length>0)for(let k of s)O.push({id:k.id,name:k.name||k.roleName,code:k.roleCode,selectType:f.type,checked:!1});n.value=O}})}function c(e,t){if(h(e),f.multi===!1){let i=n.value;for(let s of i)s.checked=!1}t.checked=!t.checked}function h(e){e.preventDefault(),e.stopPropagation()}return{register:_,showDataList:r,searchText:o,handleOk:g,selectedList:a,selectedIdList:l,unSelect:d,onSelect:c}}};const P={style:{position:"relative","min-height":"350px"}},Y={style:{width:"100%"}},q={class:"modal-select-list-container"},A={class:"scroll"},G={class:"content",style:{right:"-10px"}},J=["onClick"],K={class:"text"},Q={class:"selected-users",style:{width:"100%","overflow-x":"hidden"}};function W(f,p,o,l,_,g){const n=m("SearchOutlined"),r=m("a-input"),a=m("a-checkbox"),d=m("SelectedUserItem"),y=m("BasicModal");return v(),M(y,{onRegister:l.register,getContainer:o.getContainer,canFullscreen:!1,title:o.title,width:500,destroyOnClose:"",onOk:l.handleOk,wrapClassName:"j-user-select-modal2"},{default:w(()=>[u("div",P,[u("div",Y,[C(r,{value:l.searchText,"onUpdate:value":p[0]||(p[0]=c=>l.searchText=c),allowClear:"",style:{width:"100%"},placeholder:"搜索"},{prefix:w(()=>[C(n,{style:{color:"#c0c0c0"}})]),_:1},8,["value"])]),u("div",q,[u("div",A,[u("div",G,[(v(!0),I(R,null,U(l.showDataList,c=>(v(),I("label",{class:"item",onClick:h=>l.onSelect(h,c)},[C(a,{checked:c.checked,"onUpdate:checked":h=>c.checked=h},{default:w(()=>[u("span",K,z(c.name),1)]),_:2},1032,["checked","onUpdate:checked"])],8,J))),256))])])]),u("div",Q,[(v(!0),I(R,null,U(l.selectedList,c=>(v(),M(d,{info:c,onUnSelect:l.unSelect},null,8,["info","onUnSelect"]))),256))])])]),_:1},8,["onRegister","getContainer","title","onOk"])}const re=V(H,[["render",W],["__scopeId","data-v-3c9bd9fe"]]);export{re as default};
