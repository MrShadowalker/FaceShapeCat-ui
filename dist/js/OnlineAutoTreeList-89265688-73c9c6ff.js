import"./index-0f0d0317.js";import{C as _e,ap as Ke,bs as Je}from"./jeecg-online-vendor-f57c6456.js";import Pe from"./OnlineAutoModal-510991eb-fc2dc518.js";import Ne from"./OnlineDetailModal-9675390d-a064b8ad.js";import Ve from"./OnlineCustomModal-518ad33c-1d54cb82.js";import{f as J,w as qe,Y as c,a6 as r,a7 as S,k as f,Z as g,ab as p,aj as ze,a9 as l,E as y,F as P,aa as je,ad as D,q as Ue,A as $e,ac as A,ae as We,af as Ye,ag as Ze,ah as Ge,ai as Xe}from"./tinymce-vendor-3c2b3d6e.js";import{e as et}from"./JImportModal-15f7db6a.js";import{p as tt,d as ot}from"./useListButton-cdbab702-1beaee8c.js";import{B as nt,d as it,D as rt}from"./useExtendComponent-325fe3f1-007b9393.js";import lt from"./OnlineQueryForm-1bfc8320-01818773.js";import at from"./SuperQuery-5d1ca957-03ae60ef.js";import{a as N}from"./constant-754f1a9d-eadfd1e1.js";import"./index-64ecc8b2.js";import"./OnlineForm-1fa2d893-7d37908f.js";import"./index-09260ce4.js";import"./antd-vue-vendor-05bfa84d.js";import"./index-37448b2d.js";import"./useCustomHook-acb00837-32b1f38e.js";import"./CommentPanel-62548135.js";import"./OnlineFormDetail-0e7294ca-faf7dffa.js";import"./DetailForm-424638eb-a0926224.js";import"./index-76418551.js";import"./index-2d7d6454.js";import"./OnlineSubFormDetail-f0d2c016-93cac491.js";import"./cgformState-d9f8ec42-a08af090.js";import"./componentMap-e2e33057.js";import"./index-8e09cdad.js";import"./user.api-367a7bce.js";import"./customExpression-b2f1ff9b.js";import"./useListPage-66651993.js";import"./LinkTableListPiece-8499a318-01ebb291.js";import"./OnlineSelectCascade-4265c95d-4cbe6ffe.js";import"./JModalTip-33c7dc44-1741a3e9.js";import"./SuperQueryValComponent.vue_vue_type_script_lang-e9196096-fd4361e6.js";import st from"./BasicTable-400bb95b.js";import{Q as dt}from"./index-2ad3f236.js";import"./vxe-table-vendor-26792376.js";import"./BasicModal-9d388b71.js";import"./useWindowSizeFn-e63bb4b0.js";import"./useForm-df7d93c5.js";import"./formUtils-09c7de86.js";import"./JAddInput-a2153936.js";import"./areaDataUtil-10873080.js";import"./data-9be677e2.js";import"./useFormItem-613b6d5d.js";import"./useSelectBiz-b5c21498.js";import"./props-ea47501e.js";import"./JSelectBiz-b887fca6.js";import"./htmlmixed-6ab39e30.js";import"./codemirror-vendor-0a03fef5.js";import"./vue-41a95ea0.js";/* empty css             */import"./anyword-hint-577f8e6e.js";import"./index-d4a67b72.js";import"./bem-a6e46c9e.js";import"./props-3977d3d5.js";import"./useContextMenu-3e9e42e0.js";import"./depart.api-76b2f38a.js";import"./JSelectUser-6efbe652.js";import"./JSelectDept-073e3b74.js";import"./useTreeBiz-a3326efb.js";import"./JPopup-8248ac78.js";import"./JEllipsis-242e7bd0.js";import"./JDictSelectTag-f0227cc5.js";import"./CompTypeEnum-5c91fd88.js";import"./JTreeSelect-73cfd2cd.js";import"./JSearchSelect-4158b9a9.js";import"./JEditor-75d90eae.js";import"./index-13e7f179.js";import"./JImageUpload-1b0b2e46.js";import"./JUpload-70acb676.js";import"./injectionKey-69710956.js";import"./download-2caf3e60.js";import"./base64Conver-fa2fe1af.js";import"./index-ee632f67.js";import"./index-b5f97370.js";import"./useCountdown-d833a954.js";import"./useFormItemSingle-4fd81116.js";import"./cron-parser-vendor-a4cfb0b0.js";import"./index-3dc0c4fd.js";import"./index-aba90786.js";var O=(e,x,u)=>new Promise((i,T)=>{var C=s=>{try{a(u.next(s))}catch(h){T(h)}},m=s=>{try{a(u.throw(s))}catch(h){T(h)}},a=s=>s.done?i(s.value):Promise.resolve(s.value).then(C,m);a((u=u.apply(e,x)).next())});const ct={name:"DefaultOnlineList",components:{BasicTable:st,TableAction:dt,OnlineAutoModal:Pe,JImportModal:et,OnlineQueryForm:lt,OnlineSuperQuery:at,OnlineCustomModal:Ve,OnlineDetailModal:Ne},setup(){const{createMessage:e}=_e(),x=J(),{ID:u,onlineTableContext:i,onlineQueryFormOuter:T,loading:C,reload:m,dataSource:a,pagination:s,handleSpecialConfig:h,getColumnList:I,handleChangeInTable:F,loadData:v,superQueryButtonRef:k,superQueryStatus:E,handleSuperQuery:L,registerCustomModal:t,getTreeDataByResult:w,expandedRowKeys:d,handleExpandedRowsChange:V,tableReloading:q,onlineExtConfigJson:Q,handleFormConfig:z}=tt();if(!u.value)throw e.warning("地址错误, 配置ID不存在!"),new Error("地址错误, 配置ID不存在!");i.isTree(!0);let{initCgEnhanceJs:j}=nt(i);const{buttonSwitch:U,cgLinkButtonList:$,cgTopButtonList:W,importUrl:Y,registerModal:Z,handleAdd:H,handleEdit:G,handleBatchDelete:X,registerImportModal:ee,onImportExcel:te,onExportExcel:oe,cgButtonJsHandler:ne,cgButtonActionHandler:ie,cgButtonLinkHandler:re,handleSubmitFlow:le,getDropDownActions:ae,getActions:se,initButtonList:de,initButtonSwitch:ce,registerDetailModal:pe}=ot(i,Q),{columns:ue,actionColumn:me,selectedKeys:ge,rowSelection:he,enableScrollBar:fe,tableScroll:ye,downloadRowFile:Ce,getImgView:we,getPcaText:be,getFormatDate:Se,handleColumnResult:xe,hrefComponent:Te,viewOnlineCellImage:ke}=it(i,Q);qe(u,()=>{Re()},{immediate:!0});function Re(){return O(this,null,function*(){C.value=!0;let o=yield I(N);Be(o),yield v(),C.value=!1,i.execButtonEnhance("setup")})}function Be(o){let n=j(o.enhanceJs);i.EnhanceJS=n,de(o.cgButtonList),ce(o.hideColumns),xe(o),h(o),i.hasChildrenField=o.hasChildrenField,i.pidField=o.pidField}function De(o,n){i.queryParam=o,n===!0?m({mode:"search"}):_()}function Ie(o){return O(this,null,function*(){yield rt(k),k.value.init(o)})}function Fe(o,n){let b=d.value;if(o){if(ve(n.id),n.children.length>0&&n.children[0].isLoading===!0){let R=i.hasChildrenField;const{sortField:Oe,sortType:Qe}=i;let M=Object.assign({},{column:Oe,order:Qe});M[i.pidField]=n.id,M[R]=n[R];let He=`${i.onlineUrl.getTreeData}${i.ID}`;Ke.get({url:He,params:M},{isTransformResponse:!1}).then(B=>{B.success?Number(B.result.total)>0?n.children=w(B.result.records):(n.children="",n.hasChildrenField="0"):e.warning(B.message)}).catch(()=>{e.warning("加载子节点失败!")})}}else{let R=b.indexOf(n.id);R>=0&&(d.value=b.splice(R,1))}}function ve(o){let n=d.value;n&&n.indexOf(o)<0&&n.push(o),d.value=n}function _(){return O(this,null,function*(){i.isTree()===!0&&(d.value=[],x.value.collapseAll()),m()})}function Ee(o){if(K.value===!0){let n=o[i.pidField];if(n){let b=d.value;b.indexOf(n)<0&&b.push(n),d.value=b}}m()}const Le=o=>({label:"添加下级",onClick:Me.bind(null,o)}),K=J(!1);function Me(o){K.value=!0;let n={[i.pidField]:o.id};H(n)}function Ae(o){let n=ae(o,{themeTemplate:N});return n.unshift(Le(o)),n}return{ID:u,onlineQueryFormOuter:T,queryWithCondition:De,onQueryFormLoaded:Ie,reload:m,superQueryButtonRef:k,superQueryStatus:E,handleSuperQuery:L,loading:C,columns:ue,actionColumn:me,dataSource:a,pagination:s,rowSelection:he,selectedKeys:ge,tableScroll:ye,enableScrollBar:fe,handleChangeInTable:F,buttonSwitch:U,handleAdd:H,handleEdit:G,onImportExcel:te,onExportExcel:oe,cgTopButtonList:W,cgLinkButtonList:$,cgButtonJsHandler:ne,cgButtonActionHandler:ie,cgButtonLinkHandler:re,handleBatchDelete:X,downloadRowFile:Ce,getImgView:we,getPcaText:be,getFormatDate:Se,getActions:se,getTreeDropDownActions:Ae,registerModal:Z,registerCustomModal:t,registerImportModal:ee,importUrl:Y,handleFormConfig:z,tableReloading:q,handleSubmitFlow:le,hrefComponent:Te,viewOnlineCellImage:ke,onlineTreeTableRef:x,handlerFormSuccess:Ee,searchReset:_,handleExpand:Fe,expandedRowKeys:d,handleExpandedRowsChange:V,registerDetailModal:pe}}},pt={class:"p-2"},ut={key:0,style:{"font-size":"12px","font-style":"italic"}},mt={key:0,style:{"font-size":"12px","font-style":"italic"}},gt=["src","onClick"],ht=["innerHTML"],ft=["title"];function yt(e,x,u,i,T,C){const m=c("online-query-form"),a=c("a-button"),s=c("online-super-query"),h=c("TableAction"),I=c("BasicTable"),F=c("OnlineAutoModal"),v=c("JImportModal"),k=c("a-modal"),E=c("online-custom-modal"),L=c("online-detail-modal");return r(),S("div",pt,[f(m,{ref:"onlineQueryFormOuter",id:e.ID,onSearch:e.queryWithCondition,onLoaded:e.onQueryFormLoaded},null,8,["id","onSearch","onLoaded"]),e.tableReloading?g("",!0):(r(),p(I,{key:0,ref:"onlineTreeTableRef",isTreeTable:!0,expandedRowKeys:e.expandedRowKeys,onExpandedRowsChange:e.handleExpandedRowsChange,onExpand:e.handleExpand,rowKey:"jeecg_row_key",canResize:!0,bordered:!0,showIndexColumn:!1,loading:e.loading,columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,rowSelection:e.rowSelection,actionColumn:e.actionColumn,showTableSetting:!0,clickToRowSelect:!1,scroll:e.tableScroll,onTableRedo:e.reload,class:ze({"j-table-force-nowrap":e.enableScrollBar}),onChange:e.handleChangeInTable},{tableTitle:l(()=>[e.buttonSwitch.add?(r(),p(a,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:e.handleAdd},{default:l(()=>[y("新增")]),_:1},8,["onClick"])):g("",!0),e.buttonSwitch.import?(r(),p(a,{key:1,preIcon:"ant-design:import-outlined",type:"primary",onClick:e.onImportExcel},{default:l(()=>[y("导入")]),_:1},8,["onClick"])):g("",!0),e.buttonSwitch.export?(r(),p(a,{key:2,preIcon:"ant-design:export-outlined",type:"primary",onClick:e.onExportExcel},{default:l(()=>[y(" 导出")]),_:1},8,["onClick"])):g("",!0),e.cgTopButtonList&&e.cgTopButtonList.length>0?(r(!0),S(P,{key:3},je(e.cgTopButtonList,(t,w)=>(r(),S(P,null,[t.optType=="js"?(r(),p(a,{key:"cgbtn"+w,onClick:d=>e.cgButtonJsHandler(t.buttonCode),type:"primary",preIcon:t.buttonIcon?"ant-design:"+t.buttonIcon:""},{default:l(()=>[y(D(t.buttonName),1)]),_:2},1032,["onClick","preIcon"])):t.optType=="action"?(r(),p(a,{key:"cgbtn"+w,onClick:d=>e.cgButtonActionHandler(t.buttonCode),type:"primary",preIcon:t.buttonIcon?"ant-design:"+t.buttonIcon:""},{default:l(()=>[y(D(t.buttonName),1)]),_:2},1032,["onClick","preIcon"])):g("",!0)],64))),256)):g("",!0),e.buttonSwitch.batch_delete?Ue((r(),p(a,{key:4,preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:l(()=>[y(" 批量删除")]),_:1},8,["onClick"])),[[$e,e.selectedKeys.length>0]]):g("",!0),e.buttonSwitch.super_query?(r(),p(s,{key:5,ref:"superQueryButtonRef",online:"",status:e.superQueryStatus,onSearch:e.handleSuperQuery},null,8,["status","onSearch"])):g("",!0)]),fileSlot:l(({text:t})=>[t?(r(),p(a,{key:1,ghost:!0,type:"primary",preIcon:"ant-design:download",size:"small",onClick:w=>e.downloadRowFile(t)},{default:l(()=>[y(" 下载 ")]),_:2},1032,["onClick"])):(r(),S("span",ut,"无文件"))]),imgSlot:l(({text:t})=>[t?(r(),S("img",{key:1,src:e.getImgView(t),alt:"图片不存在",class:"online-cell-image",onClick:w=>e.viewOnlineCellImage(t)},null,8,gt)):(r(),S("span",mt,"无图片"))]),htmlSlot:l(({text:t})=>[A("div",{innerHTML:t},null,8,ht)]),pcaSlot:l(({text:t})=>[A("div",{title:e.getPcaText(t)},D(e.getPcaText(t)),9,ft)]),dateSlot:l(({text:t})=>[A("span",null,D(e.getFormatDate(t)),1)]),action:l(({record:t})=>[f(h,{actions:e.getActions(t),dropDownActions:e.getTreeDropDownActions(t)},null,8,["actions","dropDownActions"])]),_:1},8,["expandedRowKeys","onExpandedRowsChange","onExpand","loading","columns","dataSource","pagination","rowSelection","actionColumn","scroll","onTableRedo","class","onChange"])),f(F,{id:e.ID,onRegister:e.registerModal,onSuccess:e.handlerFormSuccess,onFormConfig:e.handleFormConfig},null,8,["id","onRegister","onSuccess","onFormConfig"]),f(v,{onRegister:e.registerImportModal,url:e.importUrl(),onOk:e.reload,online:""},null,8,["onRegister","url","onOk"]),f(k,We(e.hrefComponent.model,Ye(e.hrefComponent.on)),{default:l(()=>[(r(),p(Ze(e.hrefComponent.is),Ge(Xe(e.hrefComponent.params)),null,16))]),_:1},16),f(E,{onRegister:e.registerCustomModal,onSuccess:e.reload},null,8,["onRegister","onSuccess"]),f(L,{id:e.ID,onRegister:e.registerDetailModal},null,8,["id","onRegister"])])}const jo=Je(ct,[["render",yt]]);export{jo as default};
